<!DOCTYPE html>
<html>
    <head>
        <title>drag timebar reftest</title>
        <script src=media-controls.js></script>
        <script src=media-file.js></script>
    </head>
    <body>
        <video controls></video>
        <script>
            if (window.testRunner)
                testRunner.waitUntilDone();

            var video = document.querySelector("video");
            video.src = "content/test.ogv";
            video.addEventListener("loadeddata", function()
            {
                video.play();

                // Hover the mouse over the timeline so it doesn't fade out
                // while we wait for the video to play the first couple frames.
                var coords = mediaControlsButtonCoordinates(video, "timeline");
                eventSender.mouseMoveTo(coords[0], coords[1]);
            });

            var timeupdateCalls = 0;
            video.addEventListener("timeupdate", function() {
                timeupdateCalls++;

                // Let the timeupdate event occur at least twice to ensure the
                // video has rendered a couple frames.
                if (timeupdateCalls > 1) {
                    if (window.eventSender) {
                        eventSender.mouseDown();
                    }

                    if (window.testRunner)
                        testRunner.notifyDone();
                }
            });
        </script>
    </body>
</html>
