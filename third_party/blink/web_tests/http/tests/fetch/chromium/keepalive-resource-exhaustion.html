<html>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script>

promise_test((t) => {
  const n = 100;
  const promises = [];

  for (let i = 0; i < n; ++i) {
    promises.push(fetch('/', {keepalive: true}));
  }

  return promise_rejects(t, TypeError(), Promise.all(promises));
}, 'The number of requests with keepalive set should be restricted.');
</script>
