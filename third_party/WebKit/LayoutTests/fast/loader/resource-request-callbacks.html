<!DOCTYPE html>
<html>
<head>
<script src="../../resources/js-test.js"></script>
<script>
window.jsTestIsAsync = true;
if (window.testRunner) {
    testRunner.dumpAsText();
    testRunner.dumpResourceRequestCallbacks();
} else {
    document.write("This test cannot run without a testRunner");
}

function requestMoreResources() {
    document.getElementById("img-changing").src = "../images/resources/mu.png";

    var createdImage = document.createElement("img");
    createdImage.id = "img-created";
    createdImage.src = "../images/resources/oval.png";
    document.getElementById("images").appendChild(createdImage);

    document.getElementById("with-background").style.backgroundImage = "url(../images/resources/palatted-color-png-gamma-one-color-profile.png)";
    // Force a style recalc so the background image starts loading.
    getComputedStyle(document.getElementById("with-background"));

    document.getElementById("more-images").innerHTML = "<img id='img-created-2' src='../images/resources/png_per_row_alpha.png'>";

    var createdScript = document.createElement("script");
    createdScript.id = "script-created";
    createdScript.src = "../loader/resources/empty-script.js";
    document.head.appendChild(createdScript);

    setTimeout(finishTest, 0);
}

function finishTest() {
    testPassed("");
    finishJSTest();
}
</script>
<style>
#with-background
{
    background-image:url("../images/resources/lenna.png");
}
body
{
    cursor:url("../events/resources/greenbox-hotspot35-4.cur"), pointer;
}
@font-face
{
    font-family: custom_font;
    src: url("../text/resources/gw432047.ttf");
}
p
{
    font-family: custom_font;
}
</style>
</head>
<body onload="requestMoreResources()">
<div id="with-background">
<p>
    This test checks that the correct callbacks for resource requests are
    invoked. It passes if you see the callbacks for 11 resources.
</p>
</div>
<div id="images">
<img id="img-normal" src="../images/resources/dice.png" />
<img id="img-changing" src="../images/resources/dice.png" />
<img id="img-fail" />
<img id="img-not-there" src="not-existing.png" />
</div>
<div id="more-images">
</div>
<div id="console"></div>
</body>
</html>
