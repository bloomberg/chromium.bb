<!DOCTYPE html>
<html>
<title>Test that calling prompt() when backend is disabled, throws an exception</title>
<script src="../../resources/testharness.js"></script>
<script src="../../resources/testharnessreport.js"></script>
<script src="../media-file.js"></script>
<script src="util.js"></script>
<button id="button">Click me</button>
<script>
  // WPT: this test can't be moved to WPT because of its usage of:
  // - user gesture;
  // - internals.mediaPlayerRemoteRouteAvailabilityChanged
  // - internals.runtimeFlags

  function clickOnElem(e) {
    var x = e.offsetLeft + e.offsetWidth / 2;
    var y = e.offsetTop + e.offsetHeight / 2;
    chrome.gpuBenchmarking.pointerActionSequence(
    [
      {
        "source": "mouse",
        "actions":
        [
          { "name": "pointerDown", "x": x, "y": y },
          { "name": "pointerUp" }
        ]
      }
    ]);
  }

  async_test(function(t)
  {
    disableRemotePlaybackBackendForTest(t);

    var v = document.createElement('video');
    v.src = findMediaFile('video', 'content/test');
    document.body.appendChild(v);

    internals.mediaPlayerRemoteRouteAvailabilityChanged(v, true);

    var btn = document.getElementById('button');
    btn.onclick = function() {
      v.remote.prompt().then(t.unreached_func(),
          t.step_func_done(function(e) {
            assert_equals(e.name, 'NotSupportedError');
            assert_equals(e.message, 'The RemotePlayback API is disabled on this platform.');
          }));
    }

    clickOnElem(btn);
  }, 'Test that calling prompt() when backend is disabled, throws an exception.');
</script>