<!DOCTYPe html>
<title>Test that the cast button does not show up in immersive mode</title>
<script src='../../resources/testharness.js'></script>
<script src='../../resources/testharnessreport.js'></script>
<script src='../media-controls.js'></script>
<body></body>
<script>
async_test(t => {
  const old_immersive = internals.settings.immersiveModeEnabled;
  internals.settings.setImmersiveModeEnabled(true);
  t.add_cleanup(() => {
    internals.settings.setImmersiveModeEnabled(old_immersive);
  });

  const video = document.createElement('video');
  video.controls = true;
  document.body.appendChild(video);
  video.src = '../content/test.ogv';

  video.play().then(t.step_func(() => {
    // Double tap in the top right hand corner
    time = Math.round(video.currentTime);
    const coordinates =
      coordinatesOutsideElement(mediaControlsOverlayPlayButton(video));
    doubleTouchAtCoordinates(coordinates[0] + video.width, coordinates[1] + 1);

    setTimeout(t.step_func_done());
  }));

  video.addEventListener('seeked', t.unreached_func());
});
</script>
