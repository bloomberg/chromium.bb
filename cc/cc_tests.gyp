# Copyright (c) 2012 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

{
  'variables': {
    'chromium_code': 0,
    'use_libcc_for_compositor%': 0,
    'cc_tests_source_files': [
      'hash_pair_unittest.cc',
      'active_animation_unittest.cc',
      'damage_tracker_unittest.cc',
      'delay_based_time_source_unittest.cc',
      'draw_quad_unittest.cc',
      'delegated_renderer_layer_impl_unittest.cc',
      'frame_rate_controller_unittest.cc',
      'heads_up_display_unittest.cc',
      'keyframed_animation_curve_unittest.cc',
      'layer_animation_controller_unittest.cc',
      'layer_impl_unittest.cc',
      'layer_iterator_unittest.cc',
      'layer_quad_unittest.cc',
      'layer_sorter_unittest.cc',
      'layer_tree_host_common_unittest.cc',
      'layer_tree_host_impl_unittest.cc',
      'layer_tree_host_unittest.cc',
      'math_util_unittest.cc',
      'occlusion_tracker_unittest.cc',
      'prioritized_texture_unittest.cc',
      'quad_culler_unittest.cc',
      'software_renderer_unittest.cc',
      'render_pass_unittest.cc',
      'render_surface_filters_unittest.cc',
      'render_surface_unittest.cc',
      'gl_renderer_unittest.cc',
      'resource_provider_unittest.cc',
      'scheduler_state_machine_unittest.cc',
      'scheduler_unittest.cc',
      'scoped_texture_unittest.cc',
      'scrollbar_animation_controller_linear_fade_unittest.cc',
      'solid_color_layer_impl_unittest.cc',
      'texture_update_controller_unittest.cc',
      'thread_task_unittest.cc',
      'threaded_unittest.cc',
      'threaded_unittest.h',
      'CCThreadedTest.h',
      'tiled_layer_impl_unittest.cc',
      'timer_unittest.cc',
      'content_layer_unittest.cc',
      'float_quad_unittest.cc',
      'layer_unittest.cc',
      'scrollbar_layer_unittest.cc',
      'texture_copier_unittest.cc',
      'texture_layer_unittest.cc',
      'throttled_texture_uploader_unittest.cc',
      'tiled_layer_unittest.cc',
      'tree_synchronizer_unittest.cc',
    ],
    'cc_tests_support_files': [
      'test/animation_test_common.cc',
      'test/CCAnimationTestCommon.h',
      'test/geometry_test_utils.cc',
      'test/CCGeometryTestUtils.h',
      'test/layer_test_common.cc',
      'test/CCLayerTestCommon.h',
      'test/CCOcclusionTrackerTestCommon.h',
      'test/scheduler_test_common.cc',
      'test/CCSchedulerTestCommon.h',
      'test/CCRenderPassTestCommon.h',
      'test/CCTestCommon.h',
      'test/tiled_layer_test_common.cc',
      'test/CCTiledLayerTestCommon.h',
      'test/CompositorFakeWebGraphicsContext3D.h',
      'test/FakeCCGraphicsContext.h',
      'test/fake_layer_tree_host_client.cc',
      'test/FakeCCLayerTreeHostClient.h',
      'test/fake_graphics_context_3d_unittest.cc',
      'test/FakeWebCompositorSoftwareOutputDevice.h',
      'test/FakeWebCompositorOutputSurface.h',
      'test/FakeWebGraphicsContext3D.h',
      'test/FakeWebScrollbarThemeGeometry.h',
      'test/mock_quad_culler.cc',
      'test/MockCCQuadCuller.h',
      'test/WebCompositorInitializer.h',

      'test/animation_test_common.h',
      'test/geometry_test_utils.h',
      'test/layer_test_common.h',
      'test/layer_tree_test_common.h',
      'test/occlusion_tracker_test_common.h',
      'test/render_pass_test_common.h',
      'test/scheduler_test_common.h',
      'test/test_common.h',
      'test/tiled_layer_test_common.h',
      'test/compositor_fake_web_graphics_context_3d.h',
      'test/fake_graphics_context.h',
      'test/fake_layer_tree_host_client.h',
      'test/fake_web_compositor_output_surface.h',
      'test/fake_web_compositor_software_output_device.h',
      'test/fake_web_graphics_context_3d.h',
      'test/fake_web_scrollbar_theme_geometry.h',
      'test/mock_quad_culler.h',
      'test/web_compositor_initializer.h',
    ],
  },
  'targets': [
    {
      'target_name': 'cc_unittests',
      'type': 'executable',
      'dependencies': [
        '../base/base.gyp:test_support_base',
        '../testing/gtest.gyp:gtest',
        '../testing/gmock.gyp:gmock',
      ],
      'sources': [
        'test/run_all_unittests.cc',
      ],
      'conditions': [
        ['use_libcc_for_compositor==1', {
          'dependencies': [
            '../third_party/WebKit/Source/WTF/WTF.gyp/WTF.gyp:wtf',
            '../skia/skia.gyp:skia',
            'cc.gyp:cc',
            'cc_test_support',
          ],
          'defines': [
            'USE_LIBCC_FOR_COMPOSITOR',
          ],
          'include_dirs': [
            'stubs',
            'test',
            '.',
            '../third_party/WebKit/Source/Platform/chromium',
          ],
          'sources': [
            '<@(cc_tests_source_files)',
          ],
        }],
      ],
    },
  ],
  'conditions': [
    ['use_libcc_for_compositor==1', {
      'targets': [
        {
          'target_name': 'cc_test_support',
          'type': 'static_library',
          'include_dirs': [
            'stubs',
            'test',
            '.',
            '..',
            '../third_party/WebKit/Source/Platform/chromium',
          ],
          'dependencies': [
            '../ui/gl/gl.gyp:gl',
            '../testing/gtest.gyp:gtest',
            '../testing/gmock.gyp:gmock',
            '../skia/skia.gyp:skia',
            '../third_party/WebKit/Source/WTF/WTF.gyp/WTF.gyp:wtf',
            '../third_party/WebKit/Source/WebKit/chromium/WebKit.gyp:webkit_wtf_support',
            '../third_party/WebKit/Source/WebKit/chromium/WebKit.gyp:webkit',
            '../webkit/compositor_bindings/compositor_bindings.gyp:webkit_compositor_support',
            '../webkit/support/webkit_support.gyp:glue',
          ],
          'sources': [
            '<@(cc_tests_support_files)',
            'test/test_webkit_platform.cc',
            'test/test_webkit_platform.h',
          ],
        },
      ],
    }],
  ],
}
