# -*- python -*-
# Copyright (c) 2011 The Native Client Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

Import('env')


mandel_tiled_nexe_name = 'mandel_tiled_%s.nexe' % env.get('TARGET_FULLARCH')
mandel_tiled_nexe = env.ComponentProgram(mandel_tiled_nexe_name,
                                         'mandel_tiled.c',
                                         EXTRA_LIBS=[
                                             'srpc',
                                             'platform',
                                             'gio',
                                             'imc',
                                             'imc_syscalls',
                                             'pthread'])

env.Publish(mandel_tiled_nexe_name, 'run', ['mandel_tiled.html',
                                            'mandel_tiled.nmf'])


mandel_nexe_name = 'mandel_%s.nexe' % env.get('TARGET_FULLARCH')
mandel_nexe = env.ComponentProgram(mandel_nexe_name, 'mandel.c',
                                   EXTRA_LIBS=[
                                       'srpc',
                                       'platform',
                                       'gio',
                                       'imc',
                                       'imc_syscalls',
                                       'pthread'])

env.Publish(mandel_nexe_name, 'run', [])

node = env.SelUniversalTest('mandel_test.out',
                            command=[mandel_nexe],
                            stdin=env.File('test.stdin'),
                            stdout_golden=env.File('test.stdout'))
env.AddNodeToTestSuite(node, ['small_tests', 'sel_ldr_tests'], 'run_mandel')
