<link rel="import" href="chrome://resources/html/polymer.html">

<link rel="import" href="chrome://resources/html/assert.html">
<link rel="import" href="chrome://resources/html/cr/ui/focus_without_ink.html">
<link rel="import" href="chrome://resources/html/i18n_behavior.html">
<link rel="import" href="chrome://resources/html/md_select_css.html">
<link rel="import" href="chrome://resources/polymer/v1_0/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="chrome://resources/polymer/v1_0/paper-button/paper-button.html">
<link rel="import" href="chrome://resources/polymer/v1_0/paper-icon-button/paper-icon-button-light.html">
<link rel="import" href="chrome://resources/polymer/v1_0/paper-tabs/paper-tabs.html">
<link rel="import" href="chrome://resources/polymer/v1_0/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="display_layout.html">
<link rel="import" href="display_overscan_dialog.html">
<link rel="import" href="night_light_slider.html">
<link rel="import" href="../controls/settings_dropdown_menu.html">
<link rel="import" href="../controls/settings_slider.html">
<link rel="import" href="../prefs/prefs_behavior.html">
<link rel="import" href="../settings_shared_css.html">
<link rel="import" href="../settings_vars_css.html">

<dom-module id="settings-display">
  <template>
    <style include="settings-shared md-select iron-flex iron-flex-alignment">
     .settings-box.embedded {
       -webkit-margin-start: 20px;
       align-self: stretch;
       padding: 0;
     }

     :host {
       --paper-tabs-selection-bar-color: var(--paper-blue-500);
     }

     .display-tabs {
       width: 100%;
     }

     display-layout {
       align-self: stretch;
       flex: 1 1;
       height: 300px;
       margin: 10px;
     }

     .textarea {
       margin: 10px 0;
     }

     .settings-box > paper-button:first-child {
       -webkit-padding-start: 0
     }

     paper-tab {
       text-transform: uppercase;
     }

     #controlsDiv > .settings-box:first-of-type {
       border-top: none;
     }

     #nightLightSlider {
       margin-top: 20px;
     }
    </style>
    <div class="settings-box first layout vertical self-stretch">
      <h2 class="layout self-start">
        $i18n{displayArrangementTitle}
      </h2>
      <div class="secondary layout self-start"
          hidden="[[!hasMultipleDisplays_(displays)]]">
        $i18n{displayArrangementText}
      </div>
      <display-layout id="displayLayout"
          selected-display="[[selectedDisplay]]"
          on-select-display="onSelectDisplay_">
      </display-layout>
    </div>
    <div hidden="[[!hasMultipleDisplays_(displays)]]" class="settings-box">
      <paper-tabs noink selected="[[selectedDisplay.id]]" class="display-tabs"
          on-iron-select="onSelectDisplayTab_" attr-for-selected="display-id">
        <template is="dom-repeat" items="[[displays]]">
          <paper-tab display-id="[[item.id]]">[[item.name]]</paper-tab>
        </template>
      </paper-tabs>
    </div>
    <div hidden="[[hasMultipleDisplays_(displays)]]"
        class="settings-box line-only"></div>

    <div id="controlsDiv" class="settings-box layout vertical first">
      <h2>[[selectedDisplay.name]]</h2>

      <template is="dom-if" if="[[showMirror_(unifiedDesktopMode_, displays)]]"
          restamp>
        <div class="settings-box embedded two-line">
          <div class="start">
            <div id="displayMirrorCheckboxLabel">$i18n{displayMirror}</div>
            <div class="secondary">[[getDisplayMirrorText_(displays)]]</div>
          </div>
          <paper-toggle-button checked="[[isMirrored_(displays)]]"
              on-tap="onMirroredTap_"
              aria-labelledby="displayMirrorCheckboxLabel">
          </paper-toggle-button>
        </div>
      </template>

      <template is="dom-if" if="[[showUnifiedDesktop_(unifiedDesktopAvailable_,
          unifiedDesktopMode_, displays)]]" restamp>
        <div class="settings-box embedded two-line">
          <div class="start">
            <div id="displayUnifiedDesktopCheckboxLabel">
              $i18n{displayUnfiedDesktop}
            </div>
            <div class="secondary">
              [[getUnifiedDesktopText_(unifiedDesktopMode_)]]
            </div>
          </div>
          <paper-toggle-button checked="[[unifiedDesktopMode_]]"
              on-tap="onUnifiedDesktopTap_"
              aria-labelledby="displayUnifiedDesktopCheckboxLabel">
          </paper-toggle-button>
        </div>
      </template>

      <template is="dom-if" restamp
          if="[[showDisplaySelectMenu_(displays, selectedDisplay)]]">
        <div class="settings-box embedded">
          <div id="displayScreenTitle" class="start">
            $i18n{displayScreenTitle}
          </div>
          <div class="md-select-wrapper">
            <select class="md-select" on-change="updatePrimaryDisplay_"
                aria-labelledby="displayScreenTitle"
                value="[[getDisplaySelectMenuIndex_(
                    selectedDisplay, primaryDisplayId)]]">
              <option value="0">$i18n{displayScreenPrimary}</option>
              <option value="1">$i18n{displayScreenExtended}</option>
            </select>
            <span class="md-select-underline"></span>
          </div>
        </div>
      </template>

      <div class="settings-box embedded two-line">
        <div class="start textarea layout vertical">
          <div>$i18n{displayResolutionTitle}</div>
          <div class="secondary layout self-start">
            [[getResolutionText_(selectedDisplay, selectedModePref_.value)]]
          </div>
        </div>
        <settings-slider disabled="[[!enableSetResolution_(selectedDisplay)]]"
            tick-values="[[modeValues_]]" pref="{{selectedModePref_}}"
            on-change="onSelectedModeChange_">
        </settings-slider>
      </div>

      <template is="dom-if" if="[[!unifiedDesktopMode_]]" restamp>
        <div class="settings-box embedded">
          <div id="displayOrientation" class="start textarea">
            $i18n{displayOrientation}
          </div>
          <div class="md-select-wrapper">
            <select class="md-select" value="[[selectedDisplay.rotation]]"
                aria-labelledby="displayOrientation"
                on-change="onOrientationChange_">
              <option value="0">$i18n{displayOrientationStandard}</option>
              <option value="90">90</option>
              <option value="180">180</option>
              <option value="270">270</option>
            </select>
            <span class="md-select-underline"></span>
          </div>
        </div>
      </template>

      <div id="overscan" class="settings-box embedded two-line"
          on-tap="onOverscanTap_" hidden$="[[selectedDisplay.isInternal]]"
          actionable>
        <div class="start">
          $i18n{displayOverscanPageTitle}
          <div class="secondary" id="displayOverscanSecondary">
            $i18n{displayOverscanPageText}
          </div>
        </div>
        <button class="subpage-arrow" is="paper-icon-button-light"
            aria-label="$i18n{displayOverscanPageTitle}"
            aria-describedby="displayOverscanSecondary"></button>
      </div>

      <settings-display-overscan-dialog id="displayOverscan"
          display-id="{{overscanDisplayId}}"
          on-close="onCloseOverscanDialog_">
      </settings-display-overscan-dialog>

      <div class="settings-box embedded two-line"
          on-tap="onTouchCalibrationTap_"
          hidden$="[[!showTouchCalibrationSetting_(selectedDisplay)]]"
          actionable>
        <div class="start">
          $i18n{displayTouchCalibrationTitle}
          <div class="secondary" id="touchCalibrationSecondary">
            $i18n{displayTouchCalibrationText}
          </div>
        </div>
        <button class="subpage-arrow" is="paper-icon-button-light"
            aria-label="$i18n{displayTouchCalibrationTitle}"
            aria-describedby="touchCalibrationSecondary"></button>
      </div>
    </div>

    <!-- Night Light Settings -->
    <template is="dom-if" if="[[nightLightFeatureEnabled_]]" restamp>
      <div class="settings-box">
        <div class="start">
          <h2 id="nightLightLabel">$i18n{displayNightLightLabel}</h2>
          <div class="secondary">$i18n{displayNightLightText}</div>
        </div>
        <settings-toggle-button
            id="nightLightToggleButton"
            pref="{{prefs.ash.night_light.enabled}}"
            aria-labelledby="nightLightLabel">
        </settings-toggle-button>
      </div>
      <div id="nightLightSettingsDiv"
          class="settings-box continuation start layout vertical">
        <!-- Color temperature slider -->
        <div class="settings-box embedded continuation">
          <div class="start textarea" id="colorTemperatureLabel">
            $i18n{displayNightLightTemperatureLabel}
          </div>
          <settings-slider id="colorTemperatureSlider"
              aria-labelledby="colorTemperatureLabel" min="0" max="100"
              scale="100" label-min="$i18n{displayNightLightTempSliderMinLabel}"
              label-max="$i18n{displayNightLightTempSliderMaxLabel}"
              pref="{{prefs.ash.night_light.color_temperature}}">
          </settings-slider>
        </div>
        <!-- Schedule settings -->
        <div class="settings-box embedded">
          <div id="nightLightScheduleLabel" class="start textarea">
            $i18n{displayNightLightScheduleLabel}
          </div>
          <settings-dropdown-menu
              id="nightLightScheduleTypeDropDown"
              aria-labelledby="nightLightScheduleLabel"
              pref="{{prefs.ash.night_light.schedule_type}}"
              menu-options="[[scheduleTypesList_]]">
          </settings-dropdown-menu>
        </div>
        <!-- Custom schedule slider -->
        <div class="settings-box embedded continuation">
          <iron-collapse id="nightLightCustomScheduleCollapse"
              class="start textarea layout vertical"
              opened="[[shouldOpenCustomScheduleCollapse_]]">
            <div class="settings-box embedded continuation">
              <night-light-slider id="nightLightSlider" prefs="{{prefs}}">
              </night-light-slider>
            </div>
          </iron-collapse>
        </div>
      </div>
    </template>

  </template>
  <script src="display.js"></script>
</dom-module>
