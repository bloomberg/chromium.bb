<link rel="import" href="chrome://resources/html/polymer.html">

<link rel="import" href="chrome://resources/cr_elements/shared_vars_css.html">
<link rel="import" href="chrome://resources/html/util.html">
<link rel="import" href="chrome://resources/polymer/v1_0/iron-icon/iron-icon.html">
<link rel="import" href="chrome://resources/polymer/v1_0/paper-button/paper-button.html">
<link rel="import" href="chrome://resources/polymer/v1_0/paper-spinner/paper-spinner.html">
<link rel="import" href="chrome://resources/polymer/v1_0/paper-styles/color.html">
<link rel="import" href="chrome://resources/html/i18n_behavior.html">
<link rel="import" href="chrome://resources/html/web_ui_listener_behavior.html">
<link rel="import" href="../controls/controlled_button.html">
<link rel="import" href="../controls/settings_toggle_button.html">
<link rel="import" href="../settings_shared_css.html">
<link rel="import" href="chrome_cleanup_proxy.html">

<dom-module id="settings-chrome-cleanup-page">
  <template>
    <style include="settings-shared">
      #files-to-remove-container {
        /* Use the full available width for file paths to avoid inconsistent
         *  line breaks when zooming in or out */
        width: calc(var(--settings-card-max-width) -
            2 * var(--settings-box-row-padding));
      }

      #files-to-remove-list {
        word-break: break-all;
      }

      #powered-by-container {
        align-items: center;
        display: flex;
        width: 100%;
      }

      /* Used by |chromeCleanupPoweredByHTML| */
      #powered-by-logo {
        -webkit-padding-end: 2px;
        -webkit-padding-start: 5px;
        content: url(chrome://settings/partner-logo.svg);
        height: 13px;
      }

      #show-files-button {
        --paper-button-ink-color: white;
        /* Left-align the text of the button with the rest of the card's text */
        -webkit-margin-start: calc(var(--cr-button-edge-spacing) * -1);
        color: var(--google-blue-700);
        text-transform: inherit;
      }

      #status-icon {
        height: 24px;
        width: 24px;
      }

      .status-icon-container {
        -webkit-padding-end: 12px;
        min-width: 28px;
      }

      .status-icon-remove {
        --iron-icon-fill-color: var(--paper-grey-700);
      }

      .status-icon-done {
        --iron-icon-fill-color: var(--paper-blue-500);
      }

      .status-icon-warning {
        --iron-icon-fill-color: var(--paper-red-700);
      }
    </style>
    <div class="settings-box first two-line">
      <div class="status-icon-container">
        <paper-spinner id="cleaning-spinner" active="[[isRemoving_]]"
            hidden="[[!isRemoving_]]">
        </paper-spinner>
        <iron-icon icon="[[statusIcon_]]" hidden="[[isRemoving_]]"
            class$="[[statusIconClassName_]]"
            id="status-icon">
        </iron-icon>
      </div>
      <div class="start">[[title_]]</div>
      <template is="dom-if" if="[[showActionButton_]]">
        <div class="separator"></div>
        <paper-button id="action-button" class="primary-button"
            on-tap="proceed_">
          [[actionButtonLabel_]]
        </paper-button>
      </template>
    </div>
    <div id="details-container"
         class="settings-box two-line" hidden="[[!showDetails_]]">
      <div>
        $i18n{chromeCleanupExplanation}
        <a href="$i18n{chromeCleanupLearnMoreUrl}" target="_blank">
          $i18n{learnMore}
        </a>
      </div>
    </div>
    <div class="settings-box continuation" hidden="[[!showLogsPermission_]]">
      <settings-toggle-button class="start"
              id="chromeCleanupLogsUploadControl"
              label="$i18n{chromeCleanupLogsUploadPermission}"
              pref="[[logsUploadPref_]]"
              on-settings-boolean-control-change="changeLogsPermission_">
      </settings-toggle-button>
    </div>
    <div class="settings-box" hidden="[[!showDetails_]]">
      <div class="start" hidden="[[showFilesToRemove_]]">
        <paper-button id="show-files-button" on-tap="showFiles_">
          $i18n{chromeCleanupLinkShowFiles}
        </paper-button>
      </div>
      <div id="files-to-remove-container" hidden="[[!showFilesToRemove_]]">
        <ul id="files-to-remove-list" class="secondary">
          <template is="dom-repeat" items="[[filesToRemove_]]" as="fileName">
            <li>[[fileName]]</li>
          </template>
        </ul>
      </div>
    </div>
    <div class="settings-box"
        hidden="[[!showPoweredBy_(showFilesToRemove_, isPartnerPowered_)]]">
      <div id="powered-by-container" class="secondary">
        $i18nRaw{chromeCleanupPoweredByHtml}
      </div>
    </div>
  </template>
  <script src="chrome_cleanup_page.js"></script>
</dom-module>
