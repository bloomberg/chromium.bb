<!DOCTYPE HTML>
<html i18n-values="dir:textdirection;" id="t">
<head>
<meta charset="utf-8">
<title i18n-content="title"></title>

<!-- TODO(zelidrag) need a better icon here -->
<link rel="icon" href="../../app/theme/history_favicon.png">

<script src="chrome://resources/js/class_list.js"></script>
<script src="chrome://resources/js/cr.js"></script>
<script src="chrome://resources/js/cr/event_target.js"></script>
<script src="chrome://resources/js/cr/ui.js"></script>
<script src="chrome://resources/js/cr/ui/array_data_model.js"></script>
<script src="chrome://resources/js/cr/ui/list_selection_model.js"></script>
<script src="chrome://resources/js/cr/ui/list_item.js"></script>
<script src="chrome://resources/js/cr/ui/list.js"></script>
<script src="chrome://resources/js/local_strings.js"></script>
<script src="chrome://resources/js/util.js"></script>
<script src="options/preferences.js"></script>
<script src="options/pref_ui.js"></script>
<script src="options/options_page.js"></script>
<if expr="pp_ifdef('chromeos')">
  <script src="options/chromeos_internet_network_list.js"></script>
  <script src="options/chromeos_internet_options.js"></script>
  <script src="options/chromeos_language_list.js"></script>
  <script src="options/chromeos_language_options.js"></script>
  <script src="options/chromeos_system_options.js"></script>
  <script src="options/chromeos_accounts_options.js"></script>
  <script src="options/chromeos_accounts_user_list.js"></script>
  <script src="options/chromeos_accounts_user_name_edit.js"></script>
  <script>
    var AccountsOptions = options.AccountsOptions;
    var InternetOptions = options.InternetOptions;
    var LanguageHangulOptions = options.LanguageHangulOptions;
    var LanguageOptions = options.LanguageOptions;
    var SystemOptions = options.SystemOptions;
  </script>
</if>
<script src="options/add_startup_page_overlay.js"></script>
<script src="options/advanced_options.js"></script>
<script src="options/browser_options.js"></script>
<script src="options/clear_browser_data_overlay.js"></script>
<script src="options/content_settings.js"></script>
<script src="options/content_settings_exceptions_area.js"></script>
<script src="options/content_settings_ui.js"></script>
<script src="options/font_settings_overlay.js"></script>
<script src="options/import_data_overlay.js"></script>
<script src="options/personal_options.js"></script>
<script src="options/search_engine_manager.js"></script>
<script src="options/stop_syncing_overlay.js"></script>
<script>

var AddStartupPageOverlay = options.AddStartupPageOverlay;
var AdvancedOptions = options.AdvancedOptions;
var BrowserOptions = options.BrowserOptions;
var ClearBrowserDataOverlay = options.ClearBrowserDataOverlay;
var ContentSettings = options.ContentSettings;
var FontSettingsOverlay = options.FontSettingsOverlay;
var ImportDataOverlay = options.ImportDataOverlay;
var OptionsPage = options.OptionsPage;
var PersonalOptions = options.PersonalOptions;
var Preferences = options.Preferences;
var SearchEngineManager = options.SearchEngineManager;
var StopSyncingOverlay = options.StopSyncingOverlay;

/**
 * Window onload handler, sets up the page.
 */
function load() {
  localStrings = new LocalStrings();

  if (cr.isChromeOS) {
    OptionsPage.register(SystemOptions.getInstance());
    OptionsPage.register(InternetOptions.getInstance());
    // TODO(mazda): uncomment this once the language options is ready
    // OptionsPage.register(new OptionsPage(
    //     'languageChewing',
    //     localStrings.getString('languageChewingPage'),
    //     'languageChewingPage'));
    // OptionsPage.register(new OptionsPage(
    //     'languageHangul',
    //     localStrings.getString('languageHangulPage'),
    //     'languageHangulPage'));
    // OptionsPage.register(new OptionsPage(
    //     'languageMozc',
    //     localStrings.getString('languageMozcPage'),
    //     'languageMozcPage'));
    // OptionsPage.register(new OptionsPage(
    //     'languagePinyin',
    //     localStrings.getString('languagePinyinPage'),
    //     'languagePinyinPage'));
  }

  OptionsPage.register(AdvancedOptions.getInstance());
  OptionsPage.register(BrowserOptions.getInstance());
  OptionsPage.register(PersonalOptions.getInstance());
  OptionsPage.registerSubPage(ContentSettings.getInstance());
  OptionsPage.registerSubPage(SearchEngineManager.getInstance());
  OptionsPage.registerOverlay(AddStartupPageOverlay.getInstance());
  OptionsPage.registerOverlay(ClearBrowserDataOverlay.getInstance());
  OptionsPage.registerOverlay(FontSettingsOverlay.getInstance());
  OptionsPage.registerOverlay(ImportDataOverlay.getInstance());
  OptionsPage.registerOverlay(StopSyncingOverlay.getInstance());

  if (cr.isChromeOS) {
    OptionsPage.register(AccountsOptions.getInstance());
    var labsOptions = new OptionsPage('labs',
                                      localStrings.getString('labsPage'),
                                      'labsPage');
    OptionsPage.register(labsOptions);
    OptionsPage.registerSubPage(LanguageOptions.getInstance());
  }

  var syncSettings = new OptionsPage('sync',
                                     localStrings.getString('syncPage'),
                                     'syncPage');
  OptionsPage.registerSubPage(syncSettings);

  Preferences.getInstance().initialize();
  OptionsPage.initialize();

  // TODO(csilv): Save/restore last selected page.
  if (cr.isChromeOS) {
    OptionsPage.showPageByName(SystemOptions.getInstance().name);
  } else {
    OptionsPage.showPageByName(BrowserOptions.getInstance().name);
  }
}

document.addEventListener('DOMContentLoaded', load);

window.onpopstate = function(e) {
  options.OptionsPage.setState(e.state);
};
</script>
<link rel="stylesheet" href="chrome://resources/css/list.css">
<link rel="stylesheet" href="dom_ui.css">
<link rel="stylesheet" href="options/options_page.css">
<link rel="stylesheet" href="options/browser_options_page.css">
<link rel="stylesheet" href="options/content_settings_page.css">
<link rel="stylesheet" href="options/content_settings_exceptions_area.css">
<link rel="stylesheet" href="options/clear_browser_data_overlay.css">
<if expr="pp_ifdef('chromeos')">
  <link rel="stylesheet" href="options/chromeos_accounts_options_page.css">
  <link rel="stylesheet" href="options/chromeos_internet_options_page.css">
  <link rel="stylesheet" href="options/chromeos_language_options.css">
</if>
<link rel="stylesheet" href="options/personal_options.css">
</head>
<body i18n-values=".style.fontFamily:fontfamily;.style.fontSize:fontsize">
<div class="header">
</div>
<div id="overlay" class="overlay hidden">
  <div id="overlayview">
    <include src="options/add_startup_page_overlay.html">
    <include src="options/clear_browser_data_overlay.html">
    <include src="options/font_settings_overlay.html">
    <include src="options/import_data_overlay.html">
    <include src="options/stop_syncing_overlay.html">
  </div>
</div>
<div id="main-content">
  <div id="navbar-container">
     <h1 id="settings-title" i18n-content="title"></h1>
     <ul id="navbar">
     </ul>
     <hr/>
     <ul id="subpagesnav">
     </ul>
  </div>
  <div id="mainview">
     <if expr="pp_ifdef('chromeos')">
        <include src="options/chromeos_system_options.html">
        <include src="options/chromeos_internet_options.html">
        <include src="options/chromeos_language_options.html">
        <include src="options/chromeos_labs.html">
        <include src="options/chromeos_accounts_options.html">
        <!-- TODO(mazda): include the following htmls once the language options
             dialog is ready.
             - options/chromeos_language_chewing_options.html
             - options/chromeos_language_hangul_options.html
             - options/chromeos_language_mozc_options.html
             - options/chromeos_language_pinyin_options.html
        -->
     </if>
     <include src="options/advanced_options.html">
     <include src="options/browser_options.html">
     <include src="options/content_settings.html">
     <include src="options/personal_options.html">
     <include src="options/search_engine_manager.html">
     <include src="options/sync_options.html">
  </div>
</div>

<script>
// Decorate the existing elements in the document.
cr.ui.decorate('input[pref][type=checkbox]', options.PrefCheckbox);
cr.ui.decorate('input[pref][type=number]', options.PrefNumber);
cr.ui.decorate('input[pref][type=radio]', options.PrefRadio);
cr.ui.decorate('input[pref][type=range]', options.PrefRange);
cr.ui.decorate('select[pref]', options.PrefSelect);
cr.ui.decorate('input[pref][type=url]', options.PrefTextField);
cr.ui.decorate('#contentSettingsPage input[type=radio]',
    options.ContentSettingsRadio);
</script>
</body>
</html>
