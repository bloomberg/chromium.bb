<html>
  <head>
    <script>
    // Click on a link by id to star a test case.
    function clickLink(linkId) {
      var node = document.getElementById(linkId);
      if (node != null) {
        // Click and open link in the same tab.
        node.click();
      }
    }

    // Redirect to download via window.location.href
    function windowLocationHrefDownload() {
      window.location.href = "../signed.exe";
    }

    function mixRedirectDownload() {
      window.location.href = "redirect.html";
    }

    // This triggers a download in a new tab with no opener.
    function downloadInNewTab() {
      var tab = window.open('');
      tab.opener = null;
      tab.document.write('<META HTTP-EQUIV="refresh" content="0; url=../signed.exe">');
      tab.document.close();
    }
    
    // Trigger download in a new tab and the download is from a data url.
    function downloadInNewTabWithDataURL() {
       var tab = window.open('');
       tab.opener = null;
       tab.document.write('<META HTTP-EQUIV="refresh" content="0; url=data:application/octet-stream;base64,a2poYWxrc2hkbGtoYXNka2xoYXNsa2RoYWxraGtoYWxza2hka2xzamFoZGxramhhc2xka2hhc2xrZGgKYXNrZGpoa2FzZGpoYWtzaGRrYXNoZGtoYXNrZGhhc2tkaGthc2hka2Foc2RraGFrc2hka2FzaGRraGFzCmFza2pkaGFrc2hkbSxjbmtzamFoZGtoYXNrZGhhc2tka2hrYXNkCjg3MzQ2ODEyNzQ2OGtqc2hka2FoZHNrZGhraApha3NqZGthc2Roa3NkaGthc2hka2FzaGtkaAohISomXkAqJl4qYWhpZGFzeWRpeWlhc1xcb1wKa2Fqc2Roa2FzaGRrYXNoZGsKYWtzamRoc2tkaAplbmQK">');
       tab.document.close();
    }
    
    // Create a data blob and save it as a test.exe file in filesystem's
    // space with use URL filesystem:http://test_host/temporary/test.exe
    // to download it.
    function downloadViaFileApi(){
      var errorize = function(e){console.log(e);};
      var filename = 'test.exe';
      var blob = new Blob([new Uint8Array([1, 2, 3, 4])],{type:'application/octet-stream'});
      window.webkitRequestFileSystem(
        window.TEMPORARY,1048576,
        function(fs){
          var createFile = function(){
            fs.root.getFile(
              filename,
              {create:true, exclusive:true},
              function(fileEntry){
                fileEntry.createWriter(
                  function(writer){
                    writer.onwriteend = function(){
                      window.location.href = fileEntry.toURL();
                    };
                    writer.onerror = errorize;
                    writer.write(blob);
                  },
                  errorize);
              },
              errorize);
          };
          fs.root.getFile(
            filename,{create:false},
            function(fileEntry){
              fileEntry.remove(createFile,errorize);
            },
            createFile);
          },
          errorize);
    }

    </script>
  </head>
  <body>
    <a id="direct_download" href="../signed.exe">
      Direct download
    </a><br>

    <a id="direct_download_noreferrer" href="../signed.exe" rel="noreferrer">
      Direct download noreferrer
    </a><br>

    <a id="direct_download_noreferrer_target_blank" href="../signed.exe" rel="noreferrer" target=_blank>
      Direct download noreferrer target blank
    </a><br>

    <a id="single_meta_refresh_redirect" href="redirect.html">
      Redirect download via meta refresh
    </a><br>

    <a id="single_meta_refresh_redirect_target_blank" href="redirect.html" target=_blank>
      Redirect download via meta refresh target blank
    </a><br>

    <a id="multiple_meta_refresh_redirects" href="double_redirect.html">
      Redirect download multiple times via meta refresh
    </a><br>

    <a id="window_location_href_redirect" href="#" onclick="windowLocationHrefDownload()">
      Redirect download via window.location.href
    </a><br>

    <a id="mix_redirects" href="#" onclick="mixRedirectDownload()">
      Redirect download via mix of window.location.href and meta refresh
    </a><br>

    <a id="new_tab_download" href="#" onclick="downloadInNewTab()">
      Open download in new tab
    </a><br>

    <a id="new_tab_download_with_data_url" href="#" onclick="downloadInNewTabWithDataURL()">
      Open download in new tab with data url
    </a><br>

    <a id="html5_file_api" href="#" onclick="downloadViaFileApi()">
      Download via HTML5 file system API
    </a>
  </body>
</html>