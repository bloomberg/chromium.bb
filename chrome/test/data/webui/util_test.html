<!DOCTYPE html>
<html>
<body>
<script>

function testQuoteString() {
  // Basic cases.
  assertEquals('\"test\"', quoteString('"test"'));
  assertEquals('\\!\\?', quoteString('!?'));
  assertEquals('\\(\\._\\.\\) \\( \\:l \\) \\(\\.-\\.\\)',
      quoteString('(._.) ( :l ) (.-.)'));

  // Using the output as a regex.
  var re = new RegExp(quoteString('"hello"'), 'gim');
  var match = re.exec('She said "Hello" loudly');
  assertEquals(9, match.index);

  re = new RegExp(quoteString('Hello, .*'), 'gim');
  match = re.exec('Hello, world');
  assertEquals(null, match);
}

// Test the case where the origin URL is passed.
function testGetFaviconImageSet_Origin() {
  var url = 'http://foo.com';
  var expectedDesktop = '-webkit-image-set(' +
      'url("chrome://favicon/size/16@1x/origin/http://foo.com") 1x, ' +
      'url("chrome://favicon/size/16@2x/origin/http://foo.com") 2x)';
  var expectedOther = '-webkit-image-set(' +
      'url("chrome://favicon/size/16@1x/origin/http://foo.com") ' +
      window.devicePixelRatio + 'x)';

  var isDesktop = cr.isMac || cr.isChromeOS || cr.isWindows || cr.isLinux;
  var expected = isDesktop ? expectedDesktop : expectedOther;
  assertEquals(expected, getFaviconImageSet(url));
}

// Test the case where the favicon URL is passed.
function testGetFaviconImageSet_IconUrl() {
  var url = 'http://foo.com/foo.ico';
  var expectedDesktop = '-webkit-image-set(' +
      'url("chrome://favicon/size/16@1x/iconurl/http://foo.com/foo.ico") 1x, ' +
      'url("chrome://favicon/size/16@2x/iconurl/http://foo.com/foo.ico") 2x)';
  var expectedOther = '-webkit-image-set(' +
      'url("chrome://favicon/size/16@1x/iconurl/http://foo.com/foo.ico") ' +
      window.devicePixelRatio + 'x)';

  var isDesktop = cr.isMac || cr.isChromeOS || cr.isWindows || cr.isLinux;
  var expected = isDesktop ? expectedDesktop : expectedOther;
  assertEquals(expected, getFaviconImageSet(url));
}

</script>
</body>
</html>
