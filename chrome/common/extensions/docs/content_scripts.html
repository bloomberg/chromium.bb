<!DOCTYPE html><!-- This page is a placeholder for generated extensions api doc. Note:
    1) The <head> information in this page is significant, should be uniform
       across api docs and should be edited only with knowledge of the
       templating mechanism.
    3) All <body>.innerHTML is genereated as an rendering step. If viewed in a
       browser, it will be re-generated from the template, json schema and
       authored overview content.
    4) The <body>.innerHTML is also generated by an offline step so that this
       page may easily be indexed by search engines.
--><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="css/ApiRefStyles.css" rel="stylesheet" type="text/css">
    <link href="css/print.css" rel="stylesheet" type="text/css" media="print">
    <script type="text/javascript" src="../../../third_party/jstemplate/jstemplate_compiled.js">
    </script>
    <script type="text/javascript" src="js/api_page_generator.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
  <title>Content Scripts</title></head><body>  <div id="container">
      <!-- SUBTEMPLATES: DO NOT MOVE FROM THIS LOCATION -->
      <!-- In particular, sub-templates that recurse, must be used by allowing
           jstemplate to make a copy of the template in this section which
           are not operated on by way of the jsskip="true" -->
      <div style="display:none">

        <!-- VALUE -->
        <div id="valueTemplate">
          <dt>
            <var>paramName</var>
              <em>

                <!-- TYPE -->
                <div style="display:inline">
                  (
                    <span class="optional">optional</span>
                    <span id="typeTemplate">
                      <span>
                        <a> Type</a>
                      </span>
                      <span>
                        <span>
                          array of <span><span></span></span>
                        </span>
                        <span>paramType</span>
                      </span>
                    </span>
                  )
                </div>

              </em>
          </dt>
          <dd class="todo">
            Undocumented.
          </dd>
          <dd>
            Description of this parameter from the json schema.
          </dd>

          <!-- OBJECT PROPERTIES -->
          <dd>
            <dl>
              <div>
                <div>
                </div>
              </div>
            </dl>
          </dd>
        </div> <!-- /VALUE -->

      </div> <!-- /SUBTEMPLATES -->

  <a name="top"> </a>
    <!-- API HEADER -->
    <div id="pageHeader">
      <div id="searchbox">
        <form action="http://www.google.com/cse" id="cse-search-box">
          <div>
            <input type="hidden" name="cx" value="002967670403910741006:61_cvzfqtno">
            <input type="hidden" name="ie" value="UTF-8">
            <input type="text" name="q" size="31">
            <input type="submit" name="sa" value="Search">
          </div>
        </form>

        <script type="text/javascript" src="http://www.google.com/jsapi"></script>
        <script type="text/javascript">google.load("elements", "1", {packages: "transliteration"});</script>
        <script type="text/javascript" src="http://www.google.com/coop/cse/t13n?form=cse-search-box&amp;t13n_langs=en"></script>
        <script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
      </div>
      <div id="pageTitle">
        <h1>Content Scripts</h1>
      </div>
    </div> <!-- /pageHeader -->

    <div id="pageContent">
      <!-- SIDENAV -->
      <div id="leftNav">
        <ul>
          <li> <a href="index.html">Home</a></li>
          <li> <a href="getstarted.html">Getting Started</a></li>
          <li> <a href="overview.html">Overview</a></li>
          <li> <a href="devguide.html"><div>Developer's Guide</div></a>
            <ul>
              <li> Browser UI
                <ul>
                  <li><a href="browserAction.html">Browser Actions</a></li>
                  <li><a href="options.html">Options Pages</a></li>
                  <li><a href="override.html">Override Pages</a></li>
                  <li><a href="pageAction.html">Page Actions</a></li>
                  <li><a href="themes.html">Themes</a></li>
                </ul>
              </li>
              <li> Browser Interaction
                <ul>
                  <li><a href="bookmarks.html">Bookmarks</a></li>
                  <li><a href="events.html">Events</a></li>
                  <li><a href="tabs.html">Tabs</a></li>
                  <li><a href="windows.html">Windows</a></li>
                </ul>
              </li>
              <li> Implementation
                <ul>
                  <li><a href="background_pages.html">Background Pages</a></li>
                  <li class="leftNavSelected">Content Scripts</li>
                  <li><a href="xhr.html">Cross-Origin XHR</a></li>
                  <li><a href="messaging.html">Message Passing</a></li>
                  <li><a href="npapi.html">NPAPI Plugins</a></li>
                </ul>
              </li>
              <li> Finishing
                <ul>
                  <li><a href="autoupdate.html">Autoupdating</a></li>
                  <li><a href="packaging.html">Packaging</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li><a href="tutorials.html"><div>Tutorials</div></a>
            <ul>
              <li><a href="tut_debugging.html">Debugging</a></li>
            </ul>
          </li>
          <li>Reference
            <ul>
              <li> Formats
                <ul>
                  <li><a href="manifest.html">Manifest Files</a></li>
                  <li><a href="match_patterns.html">Match Patterns</a></li>
                  <!-- <li>Packages (.crx)</li> -->
                </ul>
              </li>
              <li> <a href="api_index.html">chrome.* APIs</a> </li>
              <li> <a href="api_other.html">Other APIs</a> </li>
            </ul>
          </li>
         <li><a href="samples.html">Samples</a></li>
        </ul>
      </div>

      <div id="mainColumn">
        <!-- TABLE OF CONTENTS -->
        <div id="toc">
          <p>Contents</p>
          <ol>
            <li jsinstance="0">
              <a href="#registration">Manifest</a>
              <ol>
                <li jsinstance="*0" style="display: none; ">
                  <a>h3Name</a>
                </li>
              </ol>
            </li><li jsinstance="1">
              <a href="#execution-environment">Execution environment</a>
              <ol>
                <li jsinstance="*0" style="display: none; ">
                  <a>h3Name</a>
                </li>
              </ol>
            </li><li jsinstance="2">
              <a href="#host-page-communication">Communication with the embedding page</a>
              <ol>
                <li jsinstance="*0" style="display: none; ">
                  <a>h3Name</a>
                </li>
              </ol>
            </li><li jsinstance="*3">
              <a href="#extension-files">Referring to extension files</a>
              <ol>
                <li jsinstance="*0" style="display: none; ">
                  <a>h3Name</a>
                </li>
              </ol>
            </li>
            <div style="display: none; ">
              <li>
                <a href="#apiReference">API reference</a>
                <ol>
                  <li>
                    <a href="#properties">Properties</a>
                    <ol>
                      <li>
                        <a href="#property-anchor">propertyName</a>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <a href="#methods">Methods</a>
                    <ol>
                      <li>
                        <a href="#method-anchor">methodName</a>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <a href="#events">Events</a>
                    <ol>
                      <li>
                        <a href="#event-anchor">eventName</a>
                      </li>
                    </ol>
                  </li>
                  <li>
                    <a href="#types">Types</a>
                    <ol>
                      <li>
                        <a href="#id-anchor">id</a>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
            </div>
          </ol>
        </div>
        <!-- /TABLE OF CONTENTS -->

        <!-- STATIC CONTENT PLACEHOLDER -->
        <div id="static"><div id="pageData-title" class="pageData">Content Scripts</div>
<div id="pageData-showTOC" class="pageData">true</div>

<p>
Content scripts are JavaScript files that run in the context of web pages.
By using the standard
<a href="http://www.w3.org/TR/DOM-Level-2-HTML/">Document
Object Model</a> (DOM),
they can read details of the web pages the browser visits,
or make changes to them.
</p>

<p>
Here are some examples of what content scripts can do:
</p>

<ul>
  <li>Find unlinked URLs in web pages and convert them into hyperlinks
  </li><li>Increase the font size to make text more legible
  </li><li>Find and process <a href="http://microformats.org/">microformat</a> data in the DOM
</li></ul>

<p>
However, content scripts have some limitations.
They <b>cannot</b>:
</p>

<ul>
  <li>
    Use chrome.* APIs
    (except for parts of
    <a href="extension.html"><code>chrome.extension</code></a>)
  </li>
  <li>
    Use variables or functions defined by their extension's pages
  </li>
  <li>
    Use variables or functions defined by web pages or by other content scripts
  </li>
  <li>
    Make cross-site XMLHttpRequests
  </li>
</ul>

<p>
These limitations aren't as bad as they sound.
Content scripts can <em>indirectly</em> use the chrome.* APIs,
get access to extension data,
and request extension actions
by exchanging <a href="messaging.html">messages</a>
with their parent extension.
Content scripts can also
<a href="#host-page-communication">communicate with web pages</a>
using the shared DOM.
For more insight into what content scripts can and can't do,
learn about the
<a href="#execution-environment">execution environment</a>.
</p>

<h2 id="registration">Manifest</h2>

<p>Content scripts are registered in an extension's <a href="manifest.html">manifest.json</a> file, like so:

</p><pre>{
  "name": "My First Extension",
  "version": "1.0",
  "description": "The first extension that I made.",
<span style="background:yellow; font-weight:bold;">  "content_scripts": [
    {
      "matches": ["http://www.google.com/*"],
      "css": ["mystyles.css"],
      "js": ["jquery.js", "myscript.js"]
    }
  ]</span>
}</pre>

<p>An extension can contain any number of content scripts, and a content script can consist of any number of JavaScript or CSS files. The value of the <code>matches</code> property controls when the content script will run.

</p><p>Each content script registered in the manifest can specify the following properties:</p>

<table>
  <tbody><tr>
    <th>Name</th>
    <th>Type</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>matches</td>
    <td>array of strings</td>
    <td>Required. Controls the pages this content script will be injected into.
    See <a href="match_patterns.html">Match Patterns</a>
    for more details on the syntax of these strings.</td>
  </tr>
  <tr>
    <td>js</td>
    <td><nobr>array of strings</nobr></td>
    <td>Optional. The list of JavaScript files to be injected into matching pages. These are injected in the order they appear in this array.</td>
  </tr>
  <tr>
    <td>css</td>
    <td>array of strings</td>
    <td>Optional. The list of CSS files to be injected into matching pages. These are injected in the order they appear in this array, before any DOM is constructed or displayed for the page.</td>
  </tr>
  <tr>
    <td>run_at</td>
    <td>string</td>
    <td>Optional. Controls when the files in <code>js</code> are injected. Can be <code>"document_start"</code>, <code>"document_end"</code>, or <code>"document_idle"</code>. Defaults to <code>"document_idle"</code>.
    
    <br><br>
    
    In the case of <code>"document_start"</code>, the files are injected after any files from <code>"css"</code>, but before any other DOM is constructed or any other script is run.
    
    <br><br>
    
    In the case of <code>"document_end"</code>, the files are injected immediately after the DOM is complete, but before subresources like images and frames have loaded.
    
    <br><br>
    
    In the case of <code>"document_idle"</code>, the browser chooses a time to inject scripts between <code>"document_end"</code> and immediately after the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/#handler-onload">window.onload</a></code> event fires. The exact moment of injection depends on how complex the document is and how long it is taking to load, and is optimized for page load speed.
    
    <br><br>
    
    <b>NOTE:</b> In <code>document_idle</code>, content scripts may not necessarily receive the window.onload event, because they may run after it has
    already fired. In most cases, listening for the onload event is unnecessary for content scripts running at <code>document_idle</code> because they are guaranteed to run after the DOM is complete. If your script definitely needs to run after <code>window.onload</code> you can check if it has already fired by using the <code><a href="http://www.whatwg.org/specs/web-apps/current-work/#dom-document-readystate">document.readyState</a></code> property.</td>
  </tr>
</tbody></table>


<h2 id="execution-environment">Execution environment</h2>

<p>Content scripts execute in a special environment called an <em>isolated world</em>. They have access to the DOM of the page they are injected into, but not to any JavaScript variables or functions created by the page. It looks to each content script as if there is no other JavaScript executing on the page it is running on. The same is true in reverse: JavaScript running on the page cannot call any functions or access any variables defined by content scripts.

</p><p>For example, consider this simple page:

</p><pre>hello.html
===========
&lt;html&gt;
  &lt;button id="button"&gt;click me&lt;/button&gt;
  &lt;script&gt;
    var greeting = "hello!";
    function sayGreeting() {
      alert(greeting);
    }
    document.getElementById("button").onclick = sayGreeting;
  &lt;/script&gt;
&lt;/html&gt;</pre>

<p>Now, suppose this content script was injected into hello.html:

</p><pre>contentscript.js
==================
console.log(greeting);  // undefined
console.log(sayGreeting);  // undefined
console.log(document.getElementById("button").onclick);  // still undefined
document.getElementById("button").onclick = function() {
  alert("hola!");
}</pre>

<p>Now, if the button is pressed, you will see both greetings.

</p><p>Isolated worlds allow each content script to make changes to its JavaScript environment without worrying about conflicting with the page or with other content scripts. For example, a content script could include JQuery v1 and the page could include JQuery v2, and they wouldn't conflict with each other.

</p><p>Another important benefit of isolated worlds is that they completely separate the JavaScript on the page from the JavaScript in extensions. This allows us to offer extra functionality to content scripts that should not be accessible from web pages without worrying about web pages accessing it.


</p><h2 id="host-page-communication">Communication with the embedding page</h2>

<p>Although the execution environments of content scripts and the pages that host them are isolated from each other, they share access to the page's DOM. If the page wishes to communicate with the content script (or with the extension via the content script), it must do so through the shared DOM.</p>

<p>An example can be accomplished using custom DOM events and storing data in a known location. Consider: </p>

<pre>http://foo.com/example.html
================================
var customEvent = document.createEvent('Event');
customEvent.initEvent('myCustomEvent', true, true);

function fireCustomEvent(data) {
  hiddenDiv = document.getElementById('myCustomEventDiv');
  hiddenDiv.innerHTML = data
  hiddenDiv.dispatchEvent(customEvent);
}</pre>

<pre>contentscript.js
=====================
var port = chrome.extension.connect();

document.getElementById('myCustomEventDiv').addEventListener('myCustomEvent', function() {
  var eventData = document.getElementById('myCustomEventDiv').innerHTML;
  port.postMessage({message: "myCustomEvent", values: eventData});
});</pre>

<p>In the above example, example.html (which is not a part of the extension) creates a custom event and then can decide to fire the event by setting the event data to a known location in the DOM and then dispatching the custom event. The content script listens for the name of the custom event on the known element and handles the event by inspecting the data of the element, and turning around to post the message to the extension process. In this way the page establishes a line of communication to the extension. The reverse is possible through similar means.</p>

<h2 id="extension-files">Referring to extension files</h2>

<p>
Get the URL of an extension's file using
<code>chrome.extension.getURL()</code>.
You can use the result
just like you would any other URL,
as the following code shows.
</p>


<pre><em>//Code for displaying &lt;extensionDir&gt;/images/myimage.png:</em>
var imgURL = <b>chrome.extension.getURL("images/myimage.png")</b>;
document.getElementById("someImage").src = imgURL;
</pre>
</div>

        <!-- API PAGE -->
        <div class="apiPage" style="display: none; ">
        <a name="apiReference"></a>
        <h2>API reference: chrome.apiname </h2>

          <!-- PROPERTIES -->
          <div class="apiGroup">
            <a name="properties"></a>
            <h3 id="properties">Properties</h3>

            <div>
              <a></a>
              <h4>getLastError</h4>
              <div class="summary">
                <!-- Note: intentionally longer 80 columns -->
                <span>chrome.extension</span><span>lastError</span>
              </div>
              <div>
              </div>
            </div>

          </div> <!-- /apiGroup -->

          <!-- METHODS -->
          <div class="apiGroup" id="methods">
            <a name="methods"></a>
            <h3>Methods</h3>

            <!-- iterates over all functions -->
            <div class="apiItem">
              <a></a> <!-- method-anchor -->
              <h4>method name</h4>

              <div class="summary"><span>void</span>
                  <!-- Note: intentionally longer 80 columns -->
                  <span>chrome.module.methodName</span>(<span><span>, </span><span></span>
                      <var><span></span></var></span>)</div>

              <div class="description">
                <p class="todo">Undocumented.</p>
                <p>
                  A description from the json schema def of the function goes here.
                </p>

                <!-- PARAMETERS -->
                <h4>Parameters</h4>
                <dl>
                  <div>
                    <div>
                    </div>
                  </div>
                </dl>

                <!-- RETURNS -->
                <h4>Returns</h4>
                <dl>
                  <div>
                    <div>
                    </div>
                  </div>
                </dl>

                <!-- CALLBACK -->
                <div>
                  <div>
                  <h4>Callback function</h4>
                  <p>
                    If you specify the <em>callback</em> parameter,
                    it should specify a function that looks like this:
                  </p>

                  <!-- Note: intentionally longer 80 columns -->
                  <pre>function(<span>Type param1, Type param2</span>) <span class="subdued">{...}</span>);</pre>
                  <dl>
                    <div>
                      <div>
                      </div>
                    </div>
                  </dl>
                  </div>
                </div>

              </div> <!-- /description -->

            </div>  <!-- /apiItem -->

          </div>  <!-- /apiGroup -->

          <!-- EVENTS -->
          <div class="apiGroup">
            <a name="events"></a>
            <h3 id="events">Events</h3>

            <!-- iterates over all events -->
            <div class="apiItem">
              <a></a>
              <h4>event name</h4>

              <div class="summary">
                <!-- Note: intentionally longer 80 columns -->
                <span class="subdued">chrome.bookmarks</span><span>onEvent</span><span class="subdued">.addListener</span>(function(<span>Type param1, Type param2</span>) <span class="subdued">{...}</span>);
              </div>

              <div class="description">
                <p class="todo">Undocumented.</p>
                <p>
                  A description from the json schema def of the event goes here.
                </p>

                <!-- PARAMETERS -->
                <h4>Parameters</h4>
                <dl>
                  <div>
                    <div>
                    </div>
                  </div>
                </dl>

              </div> <!-- /decription -->

            </div> <!-- /apiItem -->

          </div> <!-- /apiGroup -->

          <!-- TYPES -->
          <div class="apiGroup">
            <a name="types.sort(sortByName)"></a>
            <h3 id="types">Types</h3>

            <!-- iterates over all types -->
            <div class="apiItem">
              <a></a>
              <h4>type name</h4>

              <div>
              </div>

            </div> <!-- /apiItem -->

          </div> <!-- /apiGroup -->

        </div> <!-- /apiPage -->
      </div> <!-- /mainColumn -->
    </div> <!-- /pageContent -->
    <div id="pageFooter" --="">
  <p>
  Except as otherwise <a href="http://code.google.com/policies.html#restrictions">noted</a>,
  the content of this page is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
  Attribution 3.0 License</a>, and code samples are licensed under the
  <a rel="license" href="http://code.google.com/google_bsd_license.html">BSD License</a>.
  </p>
  <p>
  Â©2009 Google
  </p>

<!-- begin analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
<script src="http://www.google-analytics.com/ga.js" type="text/javascript"></script>

<script type="text/javascript">
  // chrome doc tracking
  try {
    var engdocs = _gat._getTracker("YT-10763712-2");
    engdocs._trackPageview();
  } catch(err) {}

  // code.google.com site-wide tracking
  try {
    _uacct="UA-18071-1";
    _uanchor=1;
    _uff=0;
    urchinTracker();
  }
  catch(e) {/* urchinTracker not available. */}
</script>
<!-- end analytics -->

    </div> <!-- /pageFooter -->
  </div> <!-- /container -->
</body></html>

