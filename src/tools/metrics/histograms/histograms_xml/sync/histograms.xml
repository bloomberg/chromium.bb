<!--
Copyright 2020 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<!--
This file is used to generate a comprehensive list of Sync histograms
along with a detailed description for each histogram.

For best practices on writing histogram descriptions, see
https://chromium.googlesource.com/chromium/src.git/+/HEAD/tools/metrics/histograms/README.md

Please send CLs to chromium-metrics-reviews@google.com rather than to specific
individuals. These CLs will be automatically reassigned to a reviewer within
about 5 minutes. This approach helps the metrics team to load-balance incoming
reviews. Googlers can read more about this at go/gwsq-gerrit.
-->

<histogram-configuration>

<histograms>

<histogram name="Sync.BackendInitializeFirstTime" units="ms"
    expires_after="2021-09-01">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Tracks sync backend initialization time during initial sync setup.
  </summary>
</histogram>

<histogram name="Sync.BackendInitializeFirstTimeSuccess" enum="BooleanSuccess"
    expires_after="2021-09-01">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Tracks sync backend initialization success rate during initial sync setup.
  </summary>
</histogram>

<histogram name="Sync.BackendInitializeRestoreSuccess" enum="BooleanSuccess"
    expires_after="2021-09-01">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Tracks sync backend initialization success rate in cases where sync was
    previously initialized.
  </summary>
</histogram>

<histogram name="Sync.BackendInitializeRestoreTime" units="ms"
    expires_after="2021-09-01">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Tracks sync backend initialization time in cases where sync was previously
    initialized.
  </summary>
</histogram>

<histogram name="Sync.BookmarkGUIDSource2" enum="BookmarkGUIDSource"
    expires_after="M89">
  <owner>rushans@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Records whether a GUID was found within BookmarkSpecifics, if an
    originator_client_item_id of valid GUID format was used to replace it, or if
    the field was left empty. Recorded when processing a remote bookmark update,
    except for permanent nodes, which are created server-side and don't have an
    originator client item ID.
  </summary>
</histogram>

<histogram name="Sync.BookmarkModelMetadataClientTagState"
    enum="SyncBookmarkModelMetadataClientTagState" expires_after="M89">
  <owner>mamir@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Represents whether the proto field client_tag_hash in locally persisted sync
    metadata is present and matches the local bookmark's GUID. It's recorded
    after successfully loading the metadata (i.e. must not be corrupt).
  </summary>
</histogram>

<histogram name="Sync.BookmarksGUIDDuplicates" enum="BookmarksGUIDDuplicates"
    expires_after="M90">
  <owner>mastiz@chromium.org</owner>
  <owner>rushans@google.com</owner>
  <summary>
    Records different types of bookmark entities having the same GUIDs. It's
    recorded on each found duplicate when processing remote bookmarks from the
    sync server during the initial merge.
  </summary>
</histogram>

<histogram name="Sync.BookmarksModelMetadataCorruptionReason"
    enum="SyncBookmarkModelMetadataCorruptionReason" expires_after="M89">
  <owner>mamir@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    The reason why the persisted metadata for a bookmark model is considered
    corrupted. It either has corrupted data or doesn't match the bookmark model.
    It's recorded at start up only if the initial sync has been performed
    already. It's recorded after loading the metadata.
  </summary>
</histogram>

<histogram name="Sync.BookmarksWithoutFullTitle.OnInitialMerge"
    units="bookmarks" expires_after="M89">
  <owner>rushans@google.com</owner>
  <owner>mastiz@chromiumg.org</owner>
  <summary>
    Number of remote bookmarks which don't have full title in specifics.
    Recorded when processing an initial merge.
  </summary>
</histogram>

<histogram name="Sync.BookmarksWithoutFullTitle.OnRemoteUpdate"
    units="bookmarks" expires_after="M89">
  <owner>rushans@google.com</owner>
  <owner>mastiz@chromiumg.org</owner>
  <summary>
    Number of remote bookmarks which don't have full title in specifics.
    Recorded when processing a remote bookmark update.
  </summary>
</histogram>

<histogram name="Sync.CommitResponse" enum="SyncerErrorValues"
    expires_after="2021-05-27">
<!-- Name completed by histogram_suffixes name="SyncModelType" -->

  <owner>rushans@google.com</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Emitted per network Commit() request to the sync server and datatype.
    Records the outcome of each commit attempt per data type (success or one of
    various error codes).
  </summary>
</histogram>

<histogram name="Sync.ConfigureDataTypeManagerOption"
    enum="SyncFeatureOrTransport" expires_after="2021-05-09">
  <owner>treib@chromium.org</owner>
  <summary>
    Whether the full Sync feature or only the Sync transport layer is being
    configured. Recorded when configuring the data types for any reason: Most
    commonly during browser startup, but also after initial setup, after a
    reconfiguration by the user, or when switching between full feature mode and
    transport mode.
  </summary>
</histogram>

<histogram name="Sync.ConfigureDataTypes" enum="SyncModelTypes"
    expires_after="2021-04-04">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Breakdown of sync data types being configured at first time signin, restart,
    or user-initiated reconfiguration. This is different from Sync.CustomTypes
    in that this captures all active devices, not just those that are choosing a
    custom sync configuration.

    Note that not all platforms support all data types. As such, comparing
    across platforms should only look at the common data types.
  </summary>
</histogram>

<histogram name="Sync.ConfigureFailed" enum="SyncModelTypes"
    expires_after="2020-10-16">
  <obsolete>
    Removed 10/2020 (and not recorded for some time before that).
  </obsolete>
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>Count of model association failures for each type.</summary>
</histogram>

<histogram base="true" name="Sync.ConfigureTime_Initial" units="ms"
    expires_after="2021-04-01">
  <owner>victorvianna@google.com</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Time spent configuring data types for the first sync. Recorded when
    DataTypeManagerImpl finishes.
  </summary>
</histogram>

<histogram base="true" name="Sync.ConfigureTime_Subsequent" units="ms"
    expires_after="2021-04-01">
  <owner>victorvianna@google.com</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Time spent configuring data types for a subsequent (i.e. non-first) sync.
    Recorded when DataTypeManagerImpl finishes.
  </summary>
</histogram>

<histogram name="Sync.CookieJarEmptyOnMismatch" enum="BooleanEmpty"
    expires_after="M77">
  <owner>zea@chromium.org</owner>
  <summary>
    Whether the gaia cookie jar was empty. Recorded on every SESSIONS commit
    where the gaia cookie jar does not include the signed in user (
    CookieJarMatchOnNavigation == false).
  </summary>
</histogram>

<histogram name="Sync.CookieJarMatchOnNavigation" enum="BooleanMatched"
    expires_after="M77">
  <owner>zea@chromium.org</owner>
  <summary>
    Whether the gaia cookie jar included the signed in user (matched) or not.
    Recorded on every SESSIONS commit.
  </summary>
</histogram>

<histogram
    name="Sync.Crypto.CustomPassphraseKeyDerivationMethodOnNewPassphrase"
    enum="SyncCustomPassphraseKeyDerivationMethodState"
    expires_after="2021-05-09">
  <owner>vitaliii@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Key derivation method used for sync custom passphrase when a new custom
    passphrase is set. &quot;Not set&quot; will never be reported for this
    metric, since we always have an explicit key derivation method when a new
    passphrase is set.
  </summary>
</histogram>

<histogram
    name="Sync.Crypto.CustomPassphraseKeyDerivationMethodOnSuccessfulDecryption"
    enum="SyncCustomPassphraseKeyDerivationMethodState"
    expires_after="2021-05-09">
  <owner>vitaliii@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Key derivation method used for sync custom passphrase on successful
    decryption of pending keys, i.e. when a passphrase is requested and the user
    types in the correct one. &quot;Not set&quot; will never be reported for
    this metric, since we always have an explicit key derivation method on
    successful decryption.
  </summary>
</histogram>

<histogram name="Sync.Crypto.CustomPassphraseKeyDerivationMethodStateOnStartup"
    enum="SyncCustomPassphraseKeyDerivationMethodState"
    expires_after="2021-04-04">
  <owner>vitaliii@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    State of the derivation method used for sync custom passphrase on startup.
    Reported only when the passphrase type is CUSTOM_PASSPHRASE.
  </summary>
</histogram>

<histogram base="true" name="Sync.Crypto.NigoriKeyDerivationDuration"
    units="ms" expires_after="2021-04-04">
  <owner>vitaliii@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Time taken to derive keys in Nigori using a given key derivation method.
    This histogram is always recorded with one of the key derivation method
    suffixes.
  </summary>
</histogram>

<histogram name="Sync.CryptographerPendingKeys"
    enum="SyncCryptographerPendingKeysState" expires_after="2021-04-18">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Breakdown of sync users whose cryptographer has pending keys.
  </summary>
</histogram>

<histogram name="Sync.CryptographerReady" enum="SyncCryptographerReadyState"
    expires_after="2021-03-07">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Breakdown of sync users whose cryptographer is fully ready for encryption
    and decryption (initialized and no pending keys).
  </summary>
</histogram>

<histogram name="Sync.CustomEncryption" enum="SyncCustomEncryptionEvent"
    expires_after="2021-01-03">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Histogram that keeps track of how users encrypt their sync data. All users
    start off with default encryption during initial setup, while a subset of
    users go on to encrypt their sync data with a custom passphrase.
  </summary>
</histogram>

<histogram name="Sync.CustomSync2" enum="SyncModelTypes" expires_after="M90">
  <owner>treib@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    For users who have *not* selected the &quot;Sync Everything&quot; option,
    this records all the data types they have selected to sync. Samples are
    taken every time the Sync data types are (re)configured, which typically
    happens during startup and when the user changes any Sync settings.
  </summary>
</histogram>

<histogram name="Sync.DataTypeRunFailures2" enum="SyncModelTypes"
    expires_after="2021-04-11">
  <owner>jkrcal@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Histogram of the run failures for the different sync datatypes. These are
    failures that occur after startup while the datatype is syncing. This is one
    of the base sync health metrics.
  </summary>
</histogram>

<histogram name="Sync.DataTypeStartFailures2" enum="SyncModelTypes"
    expires_after="2021-04-11">
  <owner>jkrcal@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Histogram of the startup failures for the different sync datatypes. These
    are failures that occur during startup before the data type is fully loaded.
    For USS datatypes, these errors are caused by failures in reading metadata
    (or data) from the DB or by another failure in interaction with the model.
    For Directory datatypes, startup errors are due to missing top level sync
    nodes or model association. This is one of the base sync health metrics.
  </summary>
</histogram>

<histogram name="Sync.DeviceCount2" units="units" expires_after="2021-05-02">
  <owner>mastiz@chromium.org</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    The largest number of active and concurrently syncing devices known to any
    profile. May be 0 when there are no signed in/syncing profiles open. Logged
    with every UMA log.
  </summary>
</histogram>

<histogram name="Sync.DuplicateBookmarkEntityOnRemoteUpdateCondition"
    enum="DuplicateBookmarkEntityOnRemoteUpdateCondition" expires_after="M89">
  <owner>rushans@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Counts the number of cases when there are duplicate sync entities while
    processing remote update. It is introduced to detect cases when one of those
    entities (or both) is a tombstone. Recorded for each duplicate entities
    within GetUpdates cycle.
  </summary>
</histogram>

<histogram base="true" name="Sync.E2ELatency" units="ms" expires_after="M90">
  <owner>mastiz@chromium.org</owner>
  <owner>melandory@chromium.org</owner>
  <summary>
    Recorded for a subset of users (Finch-controlled) per sync reflection, that
    is, server-side updates that represent a local change. The time represents
    the E2E time from the local change happening, the corresponding invalidation
    being received and the relevant updates being fetched from the sync server.
    Note: This is only recorded with a data type suffix. The base version is
    never recorded.
  </summary>
</histogram>

<histogram name="Sync.EventCodes" enum="SyncEventCode"
    expires_after="2020-10-13">
  <obsolete>
    Removed as of 10/2020.
  </obsolete>
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>A UI event occured.</summary>
</histogram>

<histogram name="Sync.InitialState" enum="SyncInitialState"
    expires_after="2021-04-04">
  <owner>treib@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    An approximate state of sync at startup. Logs a few reasons sync definitely
    wouldn't be able to start, or that it probably can start. The user having
    turned off sync on mobile will be logged as &quot;turned off by user&quot;.
    A dashboard stop and clear will fall under &quot;turned off and setup not
    completed&quot;. See the SyncInitialState enum in profile_sync_service.cc
    for more information.
  </summary>
</histogram>

<histogram name="Sync.InvalidationPerModelType" enum="SyncModelTypes"
    expires_after="never">
<!-- expires-never: For monitoring FCM based invalidations. -->

  <owner>melandory@chromium.org</owner>
  <summary>
    Histogram tracks the number of invalidations received per sync data type.
  </summary>
</histogram>

<histogram name="Sync.InvalidBookmarkSpecifics"
    enum="InvalidBookmarkSpecificsError" expires_after="2020-12-16">
  <owner>mamir@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <owner>rushans@google.com</owner>
  <summary>
    Records different causes for BookmarkSpecifics to be deemed invalid. Issues
    are recorded upon verifying validity of specifics received from the server.
  </summary>
</histogram>

<histogram name="Sync.KeystoreDecryptionFailed"
    enum="SyncKeystoreDecryptionFailure" expires_after="2021-06-01">
  <owner>mmoskvitin@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    The reason for a failure decrypting the keystore decryptor token.
  </summary>
</histogram>

<histogram name="Sync.Local.Enabled" enum="BooleanEnabled"
    expires_after="2021-05-31">
  <owner>pastarmovj@chromium.org</owner>
  <summary>
    Tracks the number of times the local sync backend was enabled by the user.
  </summary>
</histogram>

<histogram name="Sync.Local.FileSizeKB" units="KB" expires_after="2021-05-31">
  <owner>pastarmovj@chromium.org</owner>
  <summary>
    Tracks the size of the local sync backend database file. Recorded every time
    the roaming profile file is written by the client.
  </summary>
</histogram>

<histogram name="Sync.Local.RequestTypeOnError" enum="SyncRequestType"
    expires_after="2021-05-31">
  <owner>pastarmovj@chromium.org</owner>
  <summary>
    Tracks the types of requests that caused errors inside of the local server.
  </summary>
</histogram>

<histogram name="Sync.Local.RoamingProfileUnavailable" enum="BooleanError"
    expires_after="2021-05-31">
  <owner>pastarmovj@chromium.org</owner>
  <summary>
    Tracks the number of times the Roaming profile cannot be retrieved.
  </summary>
</histogram>

<histogram name="Sync.LocalSyncTransportDataStartupState"
    enum="LocalSyncTransportDataStartupState" expires_after="2021-01-17">
  <owner>rushans@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Counts cases when data in sync preferences is invalid. Recorded during sync
    startup of the Sync transport layer. It happens soon after a signed-in
    profile is opened.
  </summary>
</histogram>

<histogram name="Sync.MissingBookmarkPermanentNodes"
    enum="SyncMissingBookmarkPermanentNodes" expires_after="2020-08-02">
  <obsolete>
    Removed as of 10/2020.
  </obsolete>
  <owner>mamir@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Recorded after applying the first sync merge for Bookmarks in case of merge
    failure. Merge failure is detected by missing one or more permanent nodes in
    the merge result. This metric records which permanent nodes are missing.
    It's recorded only for USS infrastrucre.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeConfigurationTime.Ephemeral"
    units="ms" expires_after="2021-04-25">
  <owner>jkrcal@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Recorded once per activation of an ephemeral (in-memory) data type; the
    value is the duration of the setup (time from the start of the configuration
    of sync until the data type receives all its sync data and the data is ready
    for the user). This metric is used for monitoring general health of sync
    client-side code.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeConfigurationTime.Persistent"
    units="ms" expires_after="2021-05-01">
  <owner>jkrcal@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Recorded once per activation of a persistent (on-disk) data type; the value
    is the duration of the setup (time from the start of the configuration of
    sync until the data type receives all its sync data and the data is ready
    for the user). This metric is used for monitoring general health of sync
    client-side code.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeCount4" units="entries"
    expires_after="2021-04-11">
  <owner>jkrcal@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Counts the number of entries for each model type. For directory types, the
    count is based on the directory contents (excl. the root node), for USS
    types, the count is based on metadata entries for the type. Recorded after
    sync configuration. This metric is used for monitoring general health of
    sync client-side code.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeEntityChange3"
    enum="SyncEntityChange" expires_after="2021-04-11">
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Recorded once for every sync entity change (whenever it is commited to the
    server or updated from the server). This metric is used for monitoring
    general health of sync client-side code. Note: This is only recorded with a
    data type suffix. The base version is never recorded.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeErrorSite"
    enum="SyncModelTypeErrorSite" expires_after="2021-04-04">
<!-- Name completed by histogram_suffixes name="SyncModelType" -->

  <owner>jkrcal@chromium.org</owner>
  <owner>rushans@google.com</owner>
  <summary>
    Recorded whenever ClientTagBasedModelTypeProcessor triggers a data type
    failure (recorded for both Start and Run failures). It distinguishes call
    sites for triggering such failures.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeMemoryKB" units="KB"
    expires_after="2021-05-02">
  <owner>mastiz@chromium.org</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Estimated memory usage by sync datatype in kilobytes. Recorded after sync
    configuration. This metric is used for monitoring general health of sync
    client-side code.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeOrphanMetadata"
    enum="SyncModelTypes" expires_after="2021-05-01">
  <owner>jkrcal@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Records whenever an orphan metadata is encountered by the
    ClientTagBasedModelTypeProcessor.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeStoreCommitWriteBatchOutcome"
    enum="LevelDBStatus" expires_after="2021-04-04">
<!-- Name completed by histogram_suffixes name="SyncModelType" -->

  <owner>qjw@chromium.org</owner>
  <owner>ortuno@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Record the LevelDB Status outcome for ModelTypeStore CommitWriteBatch
    operations.
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeTimeUntilEncryptionKeyFound"
    units="GetUpdatesResponses" expires_after="2021-05-18">
  <owner>victorvianna@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Records how long it took from the moment the first update encrypted with
    this key was received by ModelTypeWorker, to the moment where the key was
    available to the Cryptographer. The time is measured by the number of
    GetUpdatesResponse received by the worker *while* the Cryptographer didn't
    have pending keys (and thus the key should have been known in theory).
  </summary>
</histogram>

<histogram base="true" name="Sync.ModelTypeUpdateDrop" enum="SyncModelTypes"
    expires_after="2021-05-01">
<!-- Name completed by histogram_suffixes name="SyncModelTypeUpdateDrop" -->

  <owner>jkrcal@chromium.org</owner>
  <owner>rushans@google.com</owner>
  <summary>
    Recorded whenever a remote update for a particular data type gets dropped
    for the following reason:
  </summary>
</histogram>

<histogram name="Sync.NonReflectionUpdateFreshnessPossiblySkewed2" units="ms"
    expires_after="2021-04-11">
  <owner>mastiz@chromium.org</owner>
  <owner>melandory@chromium.org</owner>
  <summary>
    Freshness of the sync data per received sync entity update, excluding
    reflections. The time represents the clock difference from the model being
    modified (usually on another device) until the change is processing by this
    instance of the browser. The time is capped at 1 week. Beware of potential
    clock skew due to two clients being involved.
  </summary>
</histogram>

<histogram name="Sync.PassphraseType" enum="SyncPassphraseType"
    expires_after="2021-04-18">
  <owner>treib@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>The active sync passphrase type at sync startup.</summary>
</histogram>

<histogram name="Sync.PassphraseType2" enum="SyncPassphraseType2"
    expires_after="never">
<!-- expires-never: important for UMA filtering. -->

  <owner>mmoskvitin@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>Sync passphrase type collected at each metrics upload.</summary>
</histogram>

<histogram name="Sync.PeakAnalysis.StopAfterAccountStateChanged" units="hits"
    expires_after="2020-10-15">
  <obsolete>
    Removed 2020-10.
  </obsolete>
  <owner>tschumann@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Number of times the Sync engine got stopped because of an account state
    change, e.g. the user signed out of the web. This should only affect the
    sync-transport layer, as the sync feature would go into sync-paused state.
    (credentials change). The histogram is emitted by minute of the emit-time to
    aid with identifying the source of regular traffic spikes. Recorded before
    the sync engine gets stopped.
  </summary>
</histogram>

<histogram name="Sync.PeakAnalysis.StopAfterCredentialsChanged" units="hits"
    expires_after="2020-10-15">
  <obsolete>
    Removed 2020-10.
  </obsolete>
  <owner>tschumann@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Number of times the Sync engine got stopped because of changed credentials.
    Today this should not happen (but we have plans to use this path for
    sync-paused state). The histogram is emitted by minute of the emit-time to
    aid with identifying the source of regular traffic spikes. Recorded before
    the sync engine gets stopped.
  </summary>
</histogram>

<histogram name="Sync.PeakAnalysis.StopOnSyncManagedPrefChange" units="hits"
    expires_after="2020-10-15">
  <obsolete>
    Removed 2020-10.
  </obsolete>
  <owner>tschumann@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Number of times the Sync engine got stopped because of a change in the
    managed-sync pref (enterprise configuration). The histogram is emitted by
    minute of the emit-time to aid with identifying the source of regular
    traffic spikes. Recorded before the sync engine gets stopped.
  </summary>
</histogram>

<histogram name="Sync.PeakAnalysis.StopOnSyncPermanentlyDisabled" units="hits"
    expires_after="2020-10-15">
  <obsolete>
    Removed 2020-10.
  </obsolete>
  <owner>tschumann@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Number of times the Sync engine got stopped because of an enterprise policy
    or the user not being signed in. The histogram is emitted by minute of the
    emit-time to aid with identifying the source of regular traffic spikes.
    Recorded before the sync engine gets stopped.
  </summary>
</histogram>

<histogram name="Sync.PersistedModelTypeIdMismatch" enum="SyncModelTypes"
    expires_after="M90">
  <owner>mastiz@chromium.org</owner>
  <owner>mamir@chromium.org</owner>
  <summary>
    Emitted when the model type id in the persisted sync metadata mismatches the
    model type id expected by the processor. It's recorded upon loading the
    metadata and before trying to connect to sync. It's recorded per data type.
  </summary>
</histogram>

<histogram name="Sync.PostedClientToServerMessage"
    enum="SyncClientToServerMessageContents" expires_after="2021-04-04">
  <owner>mastiz@chromium.org</owner>
  <summary>
    Number of network requests issued by sync to the sync server, grouped by
    content type.
  </summary>
</histogram>

<histogram name="Sync.PostedClientToServerMessageError" enum="SyncErrorType"
    expires_after="2021-04-04">
  <owner>mastiz@chromium.org</owner>
  <summary>
    A sync error code received from the sync server as a result of a
    client-initiated request. Note that this excludes network errors (e.g.
    client offline) and HTTP errors.
  </summary>
</histogram>

<histogram name="Sync.PostedClientToServerMessageLatency" units="ms"
    expires_after="2021-05-02">
  <owner>mastiz@chromium.org</owner>
  <summary>
    Time taken for a client-initiated request to be sent over the network and
    receive the response from the sync server.
  </summary>
</histogram>

<histogram name="Sync.PostedDataTypeCommitRequest" enum="SyncModelTypes"
    expires_after="2021-05-09">
  <owner>mastiz@chromium.org</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Emitted per network Commit() request to the sync server and datatype. It
    helps estimate how much load each datatype puts on the server. Note that the
    sum across buckets does not represent the total number of requests sent to
    the server, since multiple datatypes can be grouped in a single request. See
    Sync.PostedClientToServerMessage for the total number of requests/messages.
  </summary>
</histogram>

<histogram name="Sync.PostedDataTypeGetUpdatesRequest" enum="SyncModelTypes"
    expires_after="2021-05-09">
  <owner>mastiz@chromium.org</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Emitted per network GetUpdates() request to the sync server and datatype. It
    represents how much load each datatype puts on the server. Note that the sum
    across buckets does not represent the total number of requests sent to the
    server, since multiple datatypes can be grouped in a single request. See
    Sync.PostedClientToServerMessage for the total number of requests/messages.
  </summary>
</histogram>

<histogram name="Sync.PostedGetUpdatesOrigin" enum="SyncGetUpdatesOrigin"
    expires_after="2021-05-02">
  <owner>mastiz@chromium.org</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Emitted per network GetUpdates() request to the sync server, it represents
    the reason for sending such GetUpdates() request.
  </summary>
</histogram>

<histogram name="Sync.Preferences.ClearedLocalPrefOnTypeMismatch"
    units="BooleanHit" expires_after="M88">
  <owner>tschumann@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Counts the number of times a syncable pref got registered using a type that
    mismatched the type present in the pref store. In these events, the
    persisted value gets removed from the pref store.
  </summary>
</histogram>

<histogram name="Sync.ProblematicServerSideBookmarks"
    enum="RemoteBookmarkUpdateError" expires_after="M90">
  <owner>mastiz@chromium.org</owner>
  <owner>rushans@google.com</owner>
  <summary>
    Records different issues encountered when processing incremental bookmark
    updates from the sync server.
  </summary>
</histogram>

<histogram name="Sync.ProblematicServerSideBookmarksDuringMerge"
    enum="RemoteBookmarkUpdateError" expires_after="M90">
  <owner>mastiz@chromium.org</owner>
  <owner>rushans@google.com</owner>
  <summary>
    Records different issues encountered when processing remote bookmarks from
    the sync server during the initial merge procedure.
  </summary>
</histogram>

<histogram name="Sync.RedundantInvalidationPerModelType" enum="SyncModelTypes"
    expires_after="2021-01-31">
  <owner>melandory@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    The sync datatype of the recieved invalidation with not-fresh version.
  </summary>
</histogram>

<histogram name="Sync.SessionTabs" units="tabs" expires_after="2021-01-31">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    For each Chrome window, records the number of tabs present at the time Sync
    associates the SESSIONS datatype.
  </summary>
</histogram>

<histogram name="Sync.SharingMessage.CommitResult"
    enum="SyncSharingMessageCommitErrorCode" expires_after="2021-04-04">
  <owner>rushans@google.com</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Counts the number of commit results while committing sharing message.
  </summary>
</histogram>

<histogram name="Sync.Startup.DeferredInitTrigger"
    enum="SyncDeferredInitTrigger" expires_after="2021-04-11">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>The type of event that triggered sync initialization.</summary>
</histogram>

<histogram name="Sync.Startup.PolicyLoadStartupDelay" units="ms"
    expires_after="2021-11-01">
  <owner>ydago@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    The time spent waiting for policies to load before starting the sync engine.
  </summary>
</histogram>

<histogram name="Sync.Startup.PolicyLoadTimeout" enum="Boolean"
    expires_after="2021-11-01">
  <owner>ydago@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Records if the policy load delay before starting the sync engine was timed
    out. In case of a timeout, the sync engine attempts to start ignoring
    potential policy restrictions.
  </summary>
</histogram>

<histogram name="Sync.Startup.TimeDeferred2" units="ms" expires_after="M88">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Time spent after ProfileSyncService *creation* but before SyncEngine
    initialization.
  </summary>
</histogram>

<histogram name="Sync.Startup.TypeTriggeringInit" enum="SyncModelTypes"
    expires_after="2021-04-11">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>Data type that first requests sync initialization.</summary>
</histogram>

<histogram name="Sync.StopSource" enum="SyncStopSource"
    expires_after="2021-05-09">
  <owner>treib@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Tracks how sync was turned off. Logged every time sync is told to stop
    permanently by the user (e.g. it won't come back on by itself).
  </summary>
</histogram>

<histogram base="true" name="Sync.SyncedHistoryFaviconAvailability"
    enum="FaviconAvailabilityStatus" expires_after="2021-07-10">
  <owner>victorvianna@google.com</owner>
  <owner>jkrcal@chromium.org</owner>
  <summary>
    Records the availability status (local, sync or non-available) for favicons
    associated with synced history entries. Recorded when one of the following
    is displayed: entries in chrome://history that are known to be present in
    remote history data; all entries in chrome://history/syncedTabs; tabs from
    other devices in the 3 dots history menu (desktop); tabs from other devices
    in the android Recent Tabs UI.
  </summary>
</histogram>

<histogram base="true" name="Sync.SyncedHistoryFaviconLatency" units="ms"
    expires_after="2021-07-10">
  <owner>jkrcal@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Records the latency of loading favicons associated with synced history
    entries. Recorded when one of the following is displayed: entries in
    chrome://history that are known to be present in remote history data; all
    entries in chrome://history/syncedTabs; tabs from other devices in the 3
    dots history menu (desktop); tabs from other devices in the android Recent
    Tabs UI.
  </summary>
</histogram>

<histogram name="Sync.SyncErrorInfobarDisplayed" enum="SyncErrorInfobarTypes"
    expires_after="2021-08-24">
  <owner>fernandex@chromium.org</owner>
  <owner>chrome-signin-team@google.com</owner>
  <summary>
    Enumeration of error conditions that displays an infobar to the user. iOS
    only.
  </summary>
</histogram>

<histogram name="Sync.SyncEverything2" enum="Boolean"
    expires_after="2021-04-04">
  <owner>treib@chromium.org</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Boolean histogram for whether the &quot;Sync Everything&quot; option was
    selected by the user. Samples are taken every time the Sync data types are
    (re)configured, which typically happens during startup and when the user
    changes any Sync settings.
  </summary>
</histogram>

<histogram name="Sync.TrustedVaultAddKeysAttemptIsSuccessful" enum="Boolean"
    expires_after="2021-05-01">
  <owner>mmoskvitin@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Records whether attempt of adding trusted vault keys was successful (i.e.
    whether pending keys state resolved).
  </summary>
</histogram>

<histogram name="Sync.TrustedVaultErrorShownOnStartup" enum="Boolean"
    expires_after="2021-05-01">
  <owner>mmoskvitin@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Records whether user action was required to fetch trusted vault keys upon
    startup. Recorded only if trusted vault passphrase type is used and at most
    once per browser/profile lifetime.
  </summary>
</histogram>

<histogram name="Sync.TrustedVaultFetchedKeysCount" units="keys"
    expires_after="2021-05-01">
  <owner>mmoskvitin@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Records number of trusted vault keys fetched upon fetching completion.
  </summary>
</histogram>

<histogram name="Sync.TrustedVaultFetchKeysAttempt"
    enum="TrustedVaultFetchKeysAttempt" expires_after="2021-05-01">
  <owner>mmoskvitin@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>Recorded when fetching trusted vault keys is attempted.</summary>
</histogram>

<histogram name="Sync.TrustedVaultKeyRetrievalTrigger"
    enum="TrustedVaultKeyRetrievalTrigger" expires_after="2021-05-01">
  <owner>mmoskvitin@google.com</owner>
  <owner>mastiz@chromium.org</owner>
  <summary>
    Recorded when user clicks/taps on trusted vault error button. Buckets
    represents the UI elements which contain trusted vault error button.
  </summary>
</histogram>

<histogram base="true" name="Sync.UndecryptedEntitiesOnDataTypeDisabled"
    units="sync entities" expires_after="2021-04-04">
  <owner>victorvianna@google.com</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    This records the number of sync entities that were still undecrypted by the
    time the data type was disabled (typically during browser shutdown).
  </summary>
</histogram>

<histogram name="Sync.URLFetchResponse"
    enum="CombinedHttpResponseAndNetErrorCode" expires_after="2021-05-02">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Counts of responses (both http code and net error code) for Sync URL
    fetches.
  </summary>
</histogram>

<histogram name="Sync.URLFetchTime" units="ms" expires_after="M88">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Time spent waiting for a sync cycle to complete the url fetch.
  </summary>
</histogram>

<histogram name="Sync.URLFetchTimedOut" enum="BooleanTimedOut"
    expires_after="2021-01-31">
  <owner>mastiz@chromium.org</owner>
  <owner>treib@chromium.org</owner>
  <summary>
    Whether a url fetch timed out or not. Timing out implies the fetch was
    stalled for an unknown reason.
  </summary>
</histogram>

<histogram name="SyncFileSystem.ConflictResolutionPolicy"
    enum="SyncFSConflictResolutionPolicy" expires_after="M85">
  <owner>tzik@chromium.org</owner>
  <summary>
    Overridden conflict resolution policy of Sync FileSystem API. Recorded for
    each API call to override the policy.
  </summary>
</histogram>

<histogram name="SyncFileSystem.Database.Open" enum="LevelDBStatus"
    expires_after="M77">
  <owner>tzik@chromium.org</owner>
  <summary>The result of opening the Sync FileSystem backend database.</summary>
</histogram>

<histogram name="SyncFileSystem.MetadataNumber" units="units"
    expires_after="M85">
  <owner>tzik@chromium.org</owner>
  <summary>
    The number of cached backing remote file metadata in the Sync FileSystem
    database. Recorded at the initialization phase of Sync FileSystem.
  </summary>
</histogram>

<histogram name="SyncFileSystem.RegisteredAppNumber" units="units"
    expires_after="M85">
  <owner>tzik@chromium.org</owner>
  <summary>
    The number of Chrome Apps that uses Sync FileSystem with V2 backend.
    Recorded at the initialization phase of Sync FileSystem.
  </summary>
</histogram>

<histogram name="SyncFileSystem.RegisterOriginResult"
    enum="SyncFSRemoteServiceState" expires_after="2018-08-30">
  <owner>tzik@chromium.org</owner>
  <summary>
    The result of the registration of Chrome App to Sync FileSystem.
  </summary>
</histogram>

<histogram name="SyncFileSystem.RegisterOriginTime" units="ms"
    expires_after="M77">
  <owner>peria@chromium.org</owner>
  <owner>tzik@chromium.org</owner>
  <summary>
    Time elapsed to register a Chrome App to SyncFilesystem. Recorded for each
    registration request by apps.
  </summary>
</histogram>

<histogram name="SyncFileSystem.TrackerDB.Open" enum="LevelDBStatus"
    expires_after="2018-08-30">
  <owner>tzik@chromium.org</owner>
  <summary>The result of opening the Sync FileSystem tracker database.</summary>
</histogram>

<histogram name="SyncFileSystem.TrackerNumber" units="units"
    expires_after="M85">
  <owner>tzik@chromium.org</owner>
  <summary>
    The number of the directory tree node that maps backing files to local files
    in the Sync FileSystem database. Recorded at the initialization phase of
    SyncFileSystem.
  </summary>
</histogram>

</histograms>

</histogram-configuration>
