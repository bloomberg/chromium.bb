# Copyright (c) 2013 The Native Client Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.
################################################################################
# To avoid implementing whole segment register machinery in gen_dfa we manually
# enumerate all instructions allowed for TLS access.
################################################################################
# File format: see def_format.py
######## MOV %gs:0/4, %reg (for TLS access) ####################################
"mov %gs:0x0,%eax", 0x65 0xa1 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%eax", 0x65 0x8b 0x05 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%ecx", 0x65 0x8b 0x0d 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%edx", 0x65 0x8b 0x15 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%ebx", 0x65 0x8b 0x1d 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%esp", 0x65 0x8b 0x25 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%ebp", 0x65 0x8b 0x2d 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%esi", 0x65 0x8b 0x35 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x0,%edi", 0x65 0x8b 0x3d 0x00 0x00 0x00 0x00, ia32
"mov %gs:0x4,%eax", 0x65 0xa1 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%eax", 0x65 0x8b 0x05 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%ecx", 0x65 0x8b 0x0d 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%edx", 0x65 0x8b 0x15 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%ebx", 0x65 0x8b 0x1d 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%esp", 0x65 0x8b 0x25 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%ebp", 0x65 0x8b 0x2d 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%esi", 0x65 0x8b 0x35 0x04 0x00 0x00 0x00, ia32
"mov %gs:0x4,%edi", 0x65 0x8b 0x3d 0x04 0x00 0x00 0x00, ia32
################################################################################
