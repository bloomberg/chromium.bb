# Copyright 2016 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/config/chromeos/ui_mode.gni")
import("//build/config/ui.gni")
import("//extensions/buildflags/buildflags.gni")

assert(enable_extensions,
       "Cannot depend on extensions because enable_extensions=false.")

source_set("web_request") {
  sources = [
    "../declarative/declarative_api.cc",
    "../declarative/declarative_api.h",
    "../declarative/declarative_rule.h",
    "../declarative/deduping_factory.h",
    "../declarative/rules_cache_delegate.cc",
    "../declarative/rules_cache_delegate.h",
    "../declarative/rules_registry.cc",
    "../declarative/rules_registry.h",
    "../declarative/rules_registry_service.cc",
    "../declarative/rules_registry_service.h",

    # TODO(ghazale): declarative_content should be moved out of this target.
    "../declarative_content/content_rules_registry.h",
    "../declarative_webrequest/request_stage.cc",
    "../declarative_webrequest/request_stage.h",
    "../declarative_webrequest/webrequest_action.cc",
    "../declarative_webrequest/webrequest_action.h",
    "../declarative_webrequest/webrequest_condition.cc",
    "../declarative_webrequest/webrequest_condition.h",
    "../declarative_webrequest/webrequest_condition_attribute.cc",
    "../declarative_webrequest/webrequest_condition_attribute.h",
    "../declarative_webrequest/webrequest_constants.cc",
    "../declarative_webrequest/webrequest_constants.h",
    "../declarative_webrequest/webrequest_rules_registry.cc",
    "../declarative_webrequest/webrequest_rules_registry.h",
    "form_data_parser.cc",
    "form_data_parser.h",
    "permission_helper.cc",
    "permission_helper.h",
    "upload_data_presenter.cc",
    "upload_data_presenter.h",
    "web_request_api.cc",
    "web_request_api.h",
    "web_request_api_constants.cc",
    "web_request_api_constants.h",
    "web_request_api_helpers.cc",
    "web_request_api_helpers.h",
    "web_request_event_details.cc",
    "web_request_event_details.h",
    "web_request_info.cc",
    "web_request_info.h",
    "web_request_permissions.cc",
    "web_request_permissions.h",
    "web_request_proxying_url_loader_factory.cc",
    "web_request_proxying_url_loader_factory.h",
    "web_request_proxying_websocket.cc",
    "web_request_proxying_websocket.h",
    "web_request_resource_type.cc",
    "web_request_resource_type.h",
    "web_request_time_tracker.cc",
    "web_request_time_tracker.h",
  ]

  configs += [
    # TODO(jschuh): crbug.com/167187 fix size_t to int truncations.
    "//build/config/compiler:no_size_t_to_int_warning",
  ]

  deps = [
    "//build:chromeos_buildflags",
    "//components/keyed_service/content:content",
    "//components/ukm/content",
    "//components/web_cache/browser",
    "//content/public/browser",
    "//content/public/common",
    "//extensions/browser/api",
    "//extensions/browser/api/activity_log",
    "//extensions/browser/api/declarative_net_request",
    "//extensions/common",
    "//extensions/common/api",
    "//extensions/strings",
    "//services/metrics/public/cpp:metrics_cpp",
    "//services/metrics/public/cpp:ukm_builders",
    "//third_party/re2",
  ]

  if (is_chromeos_ash) {
    deps += [ "//chromeos/login/login_state:login_state" ]
  }

  if (is_chromeos_lacros) {
    deps += [
      "//chromeos/crosapi/mojom",
      "//chromeos/lacros",
    ]
  }

  public_deps = [ "//extensions/browser:browser_sources" ]
}
