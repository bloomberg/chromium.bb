import { createFilter } from '@rollup/pluginutils';
import { minifyHTMLLiterals } from 'minify-html-literals';

function minifyHTML({ include, exclude, options } = {}) {
    return {
        name: 'minify-html-template-literals',
        transform: (code, id) => {
            if (include || exclude) {
                const filter = createFilter(include, exclude);
                if (!filter(id))
                    return null;
            }
            const result = minifyHTMLLiterals(code, Object.assign({ fileName: id }, options));
            return result ? result.code : null;
        }
    };
}

export default minifyHTML;
