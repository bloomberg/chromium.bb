<html manifest="THIS_FILE_DOES_NOT_EXIST.manifest">
<head>
<!--
Generate this token with the command:
tools/origin_trials/generate_token.py http://127.0.0.1:8000 AppCache --expire-days=2000
-->
<meta http-equiv="origin-trial" content="AnwB3aSh6U8pmYtO/AzzxELSwk8BRJoj77nUnCq6u3N8LMJKlX/ImydQmXn3SgE0a+8RyowLbV835tXQHJMHuAEAAABQeyJvcmlnaW4iOiAiaHR0cDovLzEyNy4wLjAuMTo4MDAwIiwgImZlYXR1cmUiOiAiQXBwQ2FjaGUiLCAiZXhwaXJ5IjogMTc2MTE3NjE5OH0=">
  <script src="THIS_FILE_DOES_NOT_EXIST.js" type="text/javascript"></script>
  <script type="text/javascript">
    var isParentFrame = window == window.top;

    if (isParentFrame) {
        if (window.testRunner) {
            testRunner.dumpAsText()
            testRunner.waitUntilDone();
        }

        window.onmessage = function() {
            document.getElementById('result').innerHTML = "SUCCESS";
            if (window.testRunner)
                testRunner.notifyDone();
        }
    } else {
        window.applicationCache.onchecking = function() {
            parent.postMessage("hello", "*");
            parent.killChildFrame();
        }
    }

    function killChildFrame() {
        document.body.removeChild(document.getElementsByTagName("iframe")[0]);
    }
  </script>
</head>
<body>
<p>Test the destruction of an iframe while deferred events are being raised does not crash the system.</p>
<div id="result">FAILURE</div>
<iframe src="deferred-events-delete-while-raising.html"></iframe>
</body>
</html>
