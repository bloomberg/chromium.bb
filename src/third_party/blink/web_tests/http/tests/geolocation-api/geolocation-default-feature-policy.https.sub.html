<!DOCTYPE html>
<body>
<script src=/resources/testharness.js></script>
<script src=/resources/testharnessreport.js></script>
<script src=../resources/feature-policy-permissions-test.js></script>
<script src=/gen/layout_test_data/mojo/public/js/mojo_bindings.js></script>
<script src=/gen/device/geolocation/public/interfaces/geolocation.mojom.js></script>
<script src=/gen/third_party/blink/public/mojom/geolocation/geolocation_service.mojom.js></script>
<script src=/gen/third_party/blink/public/mojom/permissions/permission.mojom.js></script>
<script src=/geolocation-api/js-test-resources/geolocation-mock.js></script>

<script>
'use strict';

var mockLatitude = 51.478;
var mockLongitude = -0.166;
var mockAccuracy = 100.0;

if (!window.mojo)
    console.error('This test can not run without mojo');

let mock = geolocationMock;
mock.setGeolocationPermission(true);
mock.setGeolocationPosition(mockLatitude, mockLongitude, mockAccuracy);

run_permission_default_header_policy_tests(
  location.protocol + '//localhost:' + location.port,
  'geolocation',
  'GeolocationPositionError',
  function() { return new Promise((resolve, reject) => {
    navigator.geolocation.getCurrentPosition(resolve, reject); }); });

</script>
</body>
