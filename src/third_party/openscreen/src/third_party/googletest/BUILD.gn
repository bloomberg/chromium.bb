# Copyright 2018 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

config("gtest_config") {
  visibility = [ ":*" ]

  include_dirs = [ "src/googletest/include" ]

  cflags_cc = []
  if (is_clang) {
    cflags_cc += [ "-Wno-exit-time-destructors" ]
  }
}

config("gmock_config") {
  visibility = [ ":*" ]

  cflags_cc = [
    # issue/15: GMock does not support the override keyword.
    "-Wno-inconsistent-missing-override",
  ]
  if (is_clang) {
    cflags_cc += [ "-Wno-exit-time-destructors" ]
  }

  include_dirs = [ "src/googlemock/include" ]
}

source_set("gtest") {
  testonly = true
  sources = [
    "src/googletest/include/gtest.h",
    "src/googletest/src/gtest-all.cc",
  ]

  public_configs = [ ":gtest_config" ]

  include_dirs = [ "src/googletest" ]
}

source_set("gtest_main") {
  testonly = true
  sources = [
    "src/googletest/src/gtest_main.cc",
  ]
  deps = [
    ":gtest",
  ]
}

source_set("gmock") {
  testonly = true
  sources = [
    "src/googlemock/include/gmock.h",
    "src/googlemock/src/gmock-all.cc",
  ]

  public_configs = [
    ":gmock_config",
    ":gtest_config",
  ]

  include_dirs = [ "src/googlemock" ]
}
